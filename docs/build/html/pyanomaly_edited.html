<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyanomaly &mdash; PyAnomaly 0.921 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Support" href="support.html" />
    <link rel="prev" title="Bulding Your Own" href="building_your_own.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PyAnomaly
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#main-features">Main Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#coverage">Coverage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#structure">Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#system-requirement">System Requirement</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#comparison-to-other-sources">Comparison to Other Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#useful-links">Useful Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#glossary">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#featured-in">Featured In</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html#generating-characteristics">Generating Characteristics</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="building_your_own.html">Bulding Your Own</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pyanomaly</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.analytics">pyanomaly.analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.characteristics">pyanomaly.characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.datatools">pyanomaly.datatools</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.ff">pyanomaly.ff</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.fileio">pyanomaly.fileio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyanomaly-jkp">pyanomaly.jkp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.panel">pyanomaly.panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.portfolio">pyanomaly.portfolio</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pyanomaly-tcost">pyanomaly.tcost</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.util">pyanomaly.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyanomaly.wrdsdata">pyanomaly.wrdsdata</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyAnomaly</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>pyanomaly</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pyanomaly_edited.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyanomaly">
<span id="id1"></span><h1>pyanomaly<a class="headerlink" href="#pyanomaly" title="Permalink to this headline"></a></h1>
<span class="target" id="module-pyanomaly"></span><p>Python library for asset pricing research.</p>
<section id="module-pyanomaly.analytics">
<span id="pyanomaly-analytics"></span><h2>pyanomaly.analytics<a class="headerlink" href="#module-pyanomaly.analytics" title="Permalink to this headline"></a></h2>
<p>This module defines analytic functions.</p>
<dl class="simple">
<dt>Sorting</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">one_dim_sort()</span></code>: One-dimensional sort.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">two_dim_sort()</span></code>: Two-dimensional sort.</p></li>
</ul>
</dd>
<dt>Time-Series Analysis</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">time_series_average()</span></code>: Calculate time-series mean and t-value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rolling_beta()</span></code>: Run rolling OLS on a panel data.</p></li>
</ul>
</dd>
<dt>Cross-sectional Analysis</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">crosssectional_regression()</span></code>: Run cross-sectional OLS and calculate the time-series means and t-values of the coefficients.</p></li>
</ul>
</dd>
<dt>Portfolio Analysis</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">make_future_return()</span></code>: Compute future returns.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weighted_mean()</span></code>: Calculate weighted mean.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">make_quantile_portfolios()</span></code>: Make quantile portfolios.</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.append_long_short">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">append_long_short</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.append_long_short" title="Permalink to this definition"></a></dt>
<dd><p>Add long-short to <cite>data</cite>.</p>
<p>Long-short is defined as (first group - last group) in each date.
If labels are not given, long-short will be (class 0 - class N-1), where N is the number of classes,
and the class label of the long-short is set to N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/class1/class2/….</p></li>
<li><p><strong>level</strong> – Index level to make long-short on. Default to the last level.</p></li>
<li><p><strong>l_label</strong> – Label of the long class. If None, <cite>l_label = 0</cite>.</p></li>
<li><p><strong>s_label</strong> – Label of the short class. If None, <cite>s_label = num. classes - 1</cite>.</p></li>
<li><p><strong>ls_label</strong> – Label of the long-short. If None, <cite>ls_label = num. classes</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>data</cite> with long-short appended.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.crosssectional_regression">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">crosssectional_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endo_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.crosssectional_regression" title="Permalink to this definition"></a></dt>
<dd><p>Run cross-sectional OLS on each date and calculate the time-series means and t-values of the coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>endo_col</strong> – y column.</p></li>
<li><p><strong>exog_cols</strong> – List of X columns.</p></li>
<li><p><strong>add_constant</strong> (<em>bool</em>) – Add constant to x.</p></li>
<li><p><strong>cov_type</strong> – See <cite>sm.OLS.fit()</cite>, eg, ‘HAC’ for Newey-West.</p></li>
<li><p><strong>cov_kwds</strong> – See <cite>sm.OLS.fit()</cite>, eg, {‘maxlags: 12} for cov_type = ‘HAC’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>mean, tval, coefs.</p>
<ul class="simple">
<li><p>mean (DataFrame): Time-series means of coefficients with index = (‘const’) + <cite>exog_cols</cite> and columns = ‘mean’.</p></li>
<li><p>tval (DataFrame): t-values of coefficients with index = (‘const’) + <cite>exog_cols</cite> and columns = ‘t-stat’.</p></li>
<li><p>coefs (DataFrame): Coefficient time-series with index = dates and columns = (‘const’) + <cite>exog_cols</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_future_return">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_future_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_future_return" title="Permalink to this definition"></a></dt>
<dd><p>Compute future returns.</p>
<p>This is a simple function to compute <cite>period</cite>-period ahead return.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">Panel.cumret()</span></code></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ret</strong> – Series of returns with index = date or date/id.</p></li>
<li><p><strong>period</strong> – target period. Eg: If <cite>period</cite> = 3, 3-period ahead (cumulative) returns are returned. If <cite>ret</cite> contains monthly (daily)
returns, the output will be 3-month (day) ahead returns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of future returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_long_short_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_long_short_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lposition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sposition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_wgt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'H-L'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_long_short_portfolio" title="Permalink to this definition"></a></dt>
<dd><p>Make a long-short portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lposition</strong> (<em>DataFrame</em>) – Long position data.</p></li>
<li><p><strong>sposition</strong> (<em>DataFrame</em>) – Short position data.</p></li>
<li><p><strong>ls_wgt</strong> – Long-short weights. (1, -1) means 1:1 long-short. If None, long-short portfolio is not constructed.</p></li>
<li><p><strong>rf</strong> – Series or DataFrame of risk-free rates. The index should be date.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <code class="docutils literal notranslate"><span class="pre">pyanomaly.Portfolio</span></code> for details.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information. If position information is not needed,
set this to False to save memory.</p></li>
<li><p><strong>name</strong> – Portfolio name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_portfolio" title="Permalink to this definition"></a></dt>
<dd><p>Construct a portfolio from panel data.</p>
<p>This function creates portfolio position data from <cite>data</cite> and construct a portfolio from it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>ret_col</strong> – Return column of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column of <cite>data</cite>. If None, constituents are equally weighted.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <code class="docutils literal notranslate"><span class="pre">pyanomaly.Portfolio</span></code> for details.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information. If position information is not needed,
set this to False to save memory.</p></li>
<li><p><strong>name</strong> – Portfolio name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_position">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_position" title="Permalink to this definition"></a></dt>
<dd><p>Make portfolio position data from a panel data.</p>
<p>To construct and evaluate a portfolio using <code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> class, position data is required.
This function makes the position data from the input data, which is a panel of securities.
The position data is generated via the following operations:</p>
<blockquote>
<div><ul>
<li><p>Shift dates forward so that the return at t is the return between t-1 and t
and other variables are as of t-1.</p></li>
<li><p>Change column names as assumed in <code class="docutils literal notranslate"><span class="pre">Portfolio</span></code>:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘date’: Date column.</p></li>
<li><p>‘id’: Security id column.</p></li>
<li><p>‘ret’: Return column.</p></li>
<li><p>‘wgt’: Weight column.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Generate portfolio weights by normalizing the values given in <cite>weight_col</cite>.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id.</p></li>
<li><p><strong>ret_col</strong> – Return column of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column of <cite>data</cite>. If None, constituents are equally weighted.</p></li>
<li><p><strong>pf_col</strong> – Portfolio column of <cite>data</cite>, i.e., a column with portfolio id (name) a security belongs to.
This can be None if the input data is for one portfolio.</p></li>
<li><p><strong>other_cols</strong> – Other columns of <cite>data</cite> the user wants to keep in the position data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Position DataFrame with index = ‘date’ and columns = [‘id’, ‘ret’, ‘wgt’] + <cite>other_cols</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.make_quantile_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">make_quantile_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pf_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls_wgt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">-</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.make_quantile_portfolios" title="Permalink to this definition"></a></dt>
<dd><p>Make quantile portfolios.</p>
<p>This function makes quantile portfolios and the long-short portfolio from position data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<em>DataFrame</em>) – Position data. See <code class="docutils literal notranslate"><span class="pre">make_position()</span></code> for the format.</p></li>
<li><p><strong>pf_col</strong> – Column of <cite>position</cite> that maps a security with quantiles (portfolios).</p></li>
<li><p><strong>ls_wgt</strong> – Long-short weights. (1, -1) means 1:1 long-short. If None, long-short portfolio is not constructed.</p></li>
<li><p><strong>rf</strong> – Series or DataFrame of risk-free rates. The index should be date.</p></li>
<li><p><strong>costfcn</strong> – Transaction cost. See <code class="docutils literal notranslate"><span class="pre">pyanomaly.Portfolio</span></code> for details.</p></li>
<li><p><strong>keep_position</strong> – If True, keep the position information. If position information is not needed,
set this to False to save memory.</p></li>
<li><p><strong>labels</strong> – Portfolio names. If None, the values in <cite>pf_col</cite> are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Portfolios</span></code> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.one_dim_sort">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">one_dim_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_long_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.one_dim_sort" title="Permalink to this definition"></a></dt>
<dd><p>One-dimensional sort.</p>
<p>This function assumes that <cite>data</cite> has already been sorted/grouped and the class labels are given
in <cite>class_col</cite> column. Aggregate <cite>data[target_cols]</cite> using <cite>data[class_col]</cite> and return aggregated results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be grouped. Index must be date/id.</p></li>
<li><p><strong>class_col</strong> – Class label column.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to aggregate. If None, <cite>target_cols</cite> = all numeric columns of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If given, weighted mean is returned.</p></li>
<li><p><strong>function</strong> – Aggregate function, e.g., ‘sum’, ‘mean’, ‘count’, or a list of functions.
If <cite>function</cite> != ‘mean’, <cite>weight_col</cite> is ignored.</p></li>
<li><p><strong>add_long_short</strong> (<em>bool</em>) – Add long-short to the output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Aggregated data with index = date/class, columns = <cite>target_cols</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.relabel_class">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">relabel_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.relabel_class" title="Permalink to this definition"></a></dt>
<dd><p>Relabel classes in columns/indexes or in a column of <cite>data</cite>.</p>
<p>The existing labels should be continuous integers starting from 0.
The <cite>data</cite> is relabeled in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be relabeled.</p></li>
<li><p><strong>labels</strong> – New class labels.</p></li>
<li><p><strong>axis</strong> – 1: index, 2: column.</p></li>
<li><p><strong>level</strong> – Level of index/column to be relabeled.</p></li>
<li><p><strong>col</strong> – Column name. If column name is given, <cite>axis</cite> and <cite>level</cite> are ignored.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.rolling_beta">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">rolling_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endo_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exog_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.rolling_beta" title="Permalink to this definition"></a></dt>
<dd><p>Run rolling OLS on a panel, <cite>data</cite>.</p>
<p>The <cite>data</cite> must have index = date/id and Rolling OLS is applied to each id.
This is faster than <cite>statsmodels.RollingOLS</cite>, but the output is limited to
coefficients, R2, and idiosyncratic volatility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>window</strong> – Window size.</p></li>
<li><p><strong>minobs</strong> – Minimum number of observations in the window. If observations &lt; <cite>minobs</cite>, result is nan.</p></li>
<li><p><strong>endo_col</strong> – y column.</p></li>
<li><p><strong>exog_cols</strong> – X columns (without constant). If <cite>endo_col = exog_cols = None</cite>, <cite>endo_col = data[:, 0]</cite>,
<cite>exog_cols = data[:, 1:]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coefficients, R2, idiosyncratic volatility. These are NxK, Nx1, and Nx1 ndarrays, respectively,
where N = <cite>len(data)</cite> and K = <cite>len(exog_cols)+1</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.t_value">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">t_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.t_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculate t-value for each column under H0: x = 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with each column containing samples.</p></li>
<li><p><strong>cov_type</strong> – See <cite>sm.OLS.fit()</cite>, eg, ‘HAC’ for Newey-West.</p></li>
<li><p><strong>cov_kwds</strong> – See <cite>sm.OLS.fit()</cite>, eg, {‘maxlags: 12} for cov_type = ‘HAC’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of t-values with index = <cite>data.columns</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.time_series_average">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">time_series_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'nonrobust'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.time_series_average" title="Permalink to this definition"></a></dt>
<dd><p>Calculate time-series mean and t-value of each column (and for each group).</p>
<p><cite>data</cite> can be either a time-series data (index = date) or a panel data (index = date/group).
If it is a panel, time-series mean and t-value are calculated for each group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em>) – Data to analyze. If MultiIndex, the first index must be date.</p></li>
<li><p><strong>cov_type</strong> – See <cite>sm.OLS.fit()</cite>, eg, ‘HAC’ for Newey-West.</p></li>
<li><p><strong>cov_kwds</strong> – See <cite>sm.OLS.fit()</cite>, eg, {‘maxlags: 12} for cov_type = ‘HAC’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>mean (DataFrame), t-value (DataFrame).</p>
<ul class="simple">
<li><p>If data has MultiIndex, mean (t-value) has index = <cite>data.index[1:]</cite> and columns = <cite>data.columns</cite>.</p></li>
<li><p>Otherwise, mean (t-value) has index = <cite>data.columns</cite> and columns = ‘mean’ (‘t-stat’).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.two_dim_sort">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">two_dim_sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_long_short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.two_dim_sort" title="Permalink to this definition"></a></dt>
<dd><p>Two-dimensional sort.</p>
<p>This function assumes that <cite>data</cite> has already been sorted/grouped and the class labels are given
in <cite>class_col1</cite> and <cite>class_col2</cite> columns. Aggregate <cite>data[target_cols]</cite> using <cite>data[class_col1, class_col2]</cite> and
return aggregated results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Data to be grouped. Index must be date/id.</p></li>
<li><p><strong>class_col1/2</strong> – Class label column for the 1st (2nd) dimension.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to aggregate. If None, <cite>target_cols</cite> = all numeric columns of <cite>data</cite>.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If given, weighted mean is returned.</p></li>
<li><p><strong>function</strong> – Aggregate function, e.g., ‘sum’, ‘mean’, ‘count’. If it is other than ‘mean’, <cite>weight_col</cite> is ignored.</p></li>
<li><p><strong>add_long_short</strong> (<em>bool</em>) – Add long-short to the output.</p></li>
<li><p><strong>output_dim</strong> – If 1, output is a DataFrame with index = date/class1/class2; if 2, output is a DataFrame with
index = date/class1 and column = class2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Aggregated data (DataFrame or dict of DataFrames).</p>
<ul class="simple">
<li><p>If <cite>output_dim</cite> = 1, index = date/class1/class2 and columns = <cite>target_cols</cite>.</p></li>
<li><p>If <cite>output_dim</cite> = 2 and <cite>len(target_cols)</cite> = 1, index = date/class1 and columns = class2.</p></li>
<li><p>If <cite>output_dim</cite> = 2 and <cite>len(target_cols)</cite> &gt; 1, output is dict with keys = <cite>target_cols</cite> and
values = DataFrames (as in the second case).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.analytics.weighted_mean">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.analytics.</span></span><span class="sig-name descname"><span class="pre">weighted_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.analytics.weighted_mean" title="Permalink to this definition"></a></dt>
<dd><p>Calculate weighted means of <cite>data[target_cols]</cite> for each group defined by <cite>group_cols</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame.</p></li>
<li><p><strong>target_cols</strong> – (List of) column(s) to calculate weighted-mean.</p></li>
<li><p><strong>weight_col</strong> – Weight column name, or Series or ndarray of weights.</p></li>
<li><p><strong>group_cols</strong> – (List of) grouping column(s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of weighted mean with index = <cite>group_cols</cite> and columns = <cite>target_cols</cite>.</p>
</dd>
</dl>
<p>If <cite>data</cite> is a panel with index = ‘date’/’permno’ and column ‘ret’ contains returns
and ‘me’ contains market equity at t-1, weighted mean returns can be obtained as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wmean</span> <span class="o">=</span> <span class="n">weighted_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;ret&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="s1">&#39;permno&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-pyanomaly.characteristics">
<span id="pyanomaly-characteristics"></span><h2>pyanomaly.characteristics<a class="headerlink" href="#module-pyanomaly.characteristics" title="Permalink to this headline"></a></h2>
<p>This module defines classes for firm characteristic generation.
Refer to the cookbook for use cases.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><cite>FUNDA</cite></dt><dd><p>Class to generate firm characteristics from funda.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>FUNDQ</cite></dt><dd><p>Class to generate firm characteristics from fundq.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>CRSPM</cite></dt><dd><p>Class to generate firm characteristics from crspm.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>CRSPD</cite></dt><dd><p>Class to generate firm characteristics from crspd.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>Merge</cite></dt><dd><p>Class to generate firm characteristics from a merged dataset of funda, fundq, crspm, and crspd.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<section id="pyanomaly-characteristics-funda">
<h3>pyanomaly.characteristics.FUNDA<a class="headerlink" href="#pyanomaly-characteristics-funda" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">FUNDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.panel.Panel</span></code></a></p>
<p>Class to generate firm characteristics from funda.</p>
<p>The firm characteristics generated in this class can be viewed using <code class="docutils literal notranslate"><span class="pre">FUNDA.show_available_functions()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FUNDA</span><span class="p">()</span><span class="o">.</span><span class="n">show_available_functions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – Characteristic column name in <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>. If None, function names (without ‘c_’) are used as the
characteristic names.</p></li>
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY. Default to ANNUAL.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.add_crsp_me">
<span class="sig-name descname"><span class="pre">add_crsp_me</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crspm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'latest'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.add_crsp_me" title="Permalink to this definition"></a></dt>
<dd><p>Replace funda’s market equity (‘me’) with crspm’s firm level market equity (‘me_company’).</p>
<p>This method also adds a column ‘me_fiscal’ to <cite>data</cite>. The ‘me_fiscal’ is the me on datadate
if <cite>method</cite> = ‘latest` and it is the as me (December me) if <cite>method</cite> = ‘year_end’.
Without calling this function, me and me_fiscal are set to me of funda (prcc_f * csho).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crspm</strong> – CRSPM instance.</p></li>
<li><p><strong>method</strong> – How to merge crsp me with funda. ‘latest’: latest me; ‘year_end’: December me.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_absacc">
<span class="sig-name descname"><span class="pre">c_absacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_absacc" title="Permalink to this definition"></a></dt>
<dd><p>Absolute accruals. Bandyopadhyay, Huang, and Wirjanto (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_acc">
<span class="sig-name descname"><span class="pre">c_acc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_acc" title="Permalink to this definition"></a></dt>
<dd><p>Operating accruals (GHZ, Org). Sloan (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_age">
<span class="sig-name descname"><span class="pre">c_age</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_age" title="Permalink to this definition"></a></dt>
<dd><p>Firm age. Jiang, Lee, and Zhang (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_aliq_at">
<span class="sig-name descname"><span class="pre">c_aliq_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_aliq_at" title="Permalink to this definition"></a></dt>
<dd><p>Asset liquidity to book assets. Ortiz-Molina and Phillips (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_aliq_mat">
<span class="sig-name descname"><span class="pre">c_aliq_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_aliq_mat" title="Permalink to this definition"></a></dt>
<dd><p>Asset liquidity to market assets. Ortiz-Molina and Phillips (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_be">
<span class="sig-name descname"><span class="pre">c_at_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_be" title="Permalink to this definition"></a></dt>
<dd><p>Book leverage. Fama and French (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_gr1">
<span class="sig-name descname"><span class="pre">c_at_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_gr1" title="Permalink to this definition"></a></dt>
<dd><p>Asset growth. Cooper, Gulen, and Schill (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_me">
<span class="sig-name descname"><span class="pre">c_at_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_me" title="Permalink to this definition"></a></dt>
<dd><p>Assets-to-market. Fama and French (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_at_turnover">
<span class="sig-name descname"><span class="pre">c_at_turnover</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_at_turnover" title="Permalink to this definition"></a></dt>
<dd><p>Capital turnover. Haugen and Baker (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_be_gr1a">
<span class="sig-name descname"><span class="pre">c_be_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_be_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Chage in common equity. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_be_me">
<span class="sig-name descname"><span class="pre">c_be_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_be_me" title="Permalink to this definition"></a></dt>
<dd><p>Book-to-market (December ME). Rosenberg, Reid, and Lanstein (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_bev_mev">
<span class="sig-name descname"><span class="pre">c_bev_mev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_bev_mev" title="Permalink to this definition"></a></dt>
<dd><p>Book-to-market enterprise value. Penman, Richardson, and Tuna (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_bm_ia">
<span class="sig-name descname"><span class="pre">c_bm_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_bm_ia" title="Permalink to this definition"></a></dt>
<dd><p>Industry-adjusted book-to-market. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capex_abn">
<span class="sig-name descname"><span class="pre">c_capex_abn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capex_abn" title="Permalink to this definition"></a></dt>
<dd><p>Abnormal corporate investment. Titman, Wei, and Xie (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr1">
<span class="sig-name descname"><span class="pre">c_capx_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr1" title="Permalink to this definition"></a></dt>
<dd><p>CAPEX growth (1 year). Xie (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr2">
<span class="sig-name descname"><span class="pre">c_capx_gr2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr2" title="Permalink to this definition"></a></dt>
<dd><p>Two-year investment growth. Anderson and Garcia-Feijoo (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_capx_gr3">
<span class="sig-name descname"><span class="pre">c_capx_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_capx_gr3" title="Permalink to this definition"></a></dt>
<dd><p>Three-year investment growth. Anderson and Garcia-Feijoo (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cash_at">
<span class="sig-name descname"><span class="pre">c_cash_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cash_at" title="Permalink to this definition"></a></dt>
<dd><p>Cash-to-assets. Palazzo (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cashdebt">
<span class="sig-name descname"><span class="pre">c_cashdebt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cashdebt" title="Permalink to this definition"></a></dt>
<dd><p>Cash flow-to-debt. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cashpr">
<span class="sig-name descname"><span class="pre">c_cashpr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cashpr" title="Permalink to this definition"></a></dt>
<dd><p>Cash productivity. Chandrashekar and Rao (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cfp">
<span class="sig-name descname"><span class="pre">c_cfp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cfp" title="Permalink to this definition"></a></dt>
<dd><p>Operating Cash flows to price (Org, GHZ). Desai, Rajgopal, and Venkatachalam (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cfp_ia">
<span class="sig-name descname"><span class="pre">c_cfp_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cfp_ia" title="Permalink to this definition"></a></dt>
<dd><p>Industry-adjusted cash flow-to-price. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chatoia">
<span class="sig-name descname"><span class="pre">c_chatoia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chatoia" title="Permalink to this definition"></a></dt>
<dd><p>Change in profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chcsho">
<span class="sig-name descname"><span class="pre">c_chcsho</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chcsho" title="Permalink to this definition"></a></dt>
<dd><p>Net stock issues (GHZ). Pontiff and Woodgate (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chempia">
<span class="sig-name descname"><span class="pre">c_chempia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chempia" title="Permalink to this definition"></a></dt>
<dd><p>Industry-adjusted change in employees. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_chpmia">
<span class="sig-name descname"><span class="pre">c_chpmia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_chpmia" title="Permalink to this definition"></a></dt>
<dd><p>Change in profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_coa_gr1a">
<span class="sig-name descname"><span class="pre">c_coa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_coa_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_col_gr1a">
<span class="sig-name descname"><span class="pre">c_col_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_col_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in current Ooperating liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_convind">
<span class="sig-name descname"><span class="pre">c_convind</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_convind" title="Permalink to this definition"></a></dt>
<dd><p>Convertible debt indicator. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cop_at">
<span class="sig-name descname"><span class="pre">c_cop_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cop_at" title="Permalink to this definition"></a></dt>
<dd><p>Cash-based operating profitablility. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cop_atl1">
<span class="sig-name descname"><span class="pre">c_cop_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cop_atl1" title="Permalink to this definition"></a></dt>
<dd><p>Cash-based operating profits to lagged assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_cowc_gr1a">
<span class="sig-name descname"><span class="pre">c_cowc_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_cowc_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in net non-cash working capital. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_currat">
<span class="sig-name descname"><span class="pre">c_currat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_currat" title="Permalink to this definition"></a></dt>
<dd><p>Current ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dbnetis_at">
<span class="sig-name descname"><span class="pre">c_dbnetis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dbnetis_at" title="Permalink to this definition"></a></dt>
<dd><p>Net debt finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_debt_gr3">
<span class="sig-name descname"><span class="pre">c_debt_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_debt_gr3" title="Permalink to this definition"></a></dt>
<dd><p>Composite debt issuance. Lyandres, Sun, and Zhang (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_debt_me">
<span class="sig-name descname"><span class="pre">c_debt_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_debt_me" title="Permalink to this definition"></a></dt>
<dd><p>Debt to market. Bhandari (1988)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_depr">
<span class="sig-name descname"><span class="pre">c_depr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_depr" title="Permalink to this definition"></a></dt>
<dd><p>Depreciation to PP&amp;E. Holthausen and Larcker (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dgp_dsale">
<span class="sig-name descname"><span class="pre">c_dgp_dsale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dgp_dsale" title="Permalink to this definition"></a></dt>
<dd><p>Gross margin growth to sales growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_dinv">
<span class="sig-name descname"><span class="pre">c_dsale_dinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_dinv" title="Permalink to this definition"></a></dt>
<dd><p>Sales growth to inventory growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_drec">
<span class="sig-name descname"><span class="pre">c_dsale_drec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_drec" title="Permalink to this definition"></a></dt>
<dd><p>Sales growth to receivable growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dsale_dsga">
<span class="sig-name descname"><span class="pre">c_dsale_dsga</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dsale_dsga" title="Permalink to this definition"></a></dt>
<dd><p>Sales growth to SG&amp;A growth. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_dy">
<span class="sig-name descname"><span class="pre">c_dy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_dy" title="Permalink to this definition"></a></dt>
<dd><p>Dividend yield (GHZ). Litzenberger and Ramaswamy (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_earnings_variability">
<span class="sig-name descname"><span class="pre">c_earnings_variability</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_earnings_variability" title="Permalink to this definition"></a></dt>
<dd><p>Earnings smoothness. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebit_bev">
<span class="sig-name descname"><span class="pre">c_ebit_bev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebit_bev" title="Permalink to this definition"></a></dt>
<dd><p>Return on net operating assets. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebit_sale">
<span class="sig-name descname"><span class="pre">c_ebit_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebit_sale" title="Permalink to this definition"></a></dt>
<dd><p>Profit margin. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ebitda_mev">
<span class="sig-name descname"><span class="pre">c_ebitda_mev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ebitda_mev" title="Permalink to this definition"></a></dt>
<dd><p>Enterprise multiple. Loughran and Wellman (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_emp_gr1">
<span class="sig-name descname"><span class="pre">c_emp_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_emp_gr1" title="Permalink to this definition"></a></dt>
<dd><p>Employee growth. Belo, Lin, and Bazdresch (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eq_dur">
<span class="sig-name descname"><span class="pre">c_eq_dur</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eq_dur" title="Permalink to this definition"></a></dt>
<dd><p>Equity duration. Dechow, Sloan, and Soliman (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqnetis_at">
<span class="sig-name descname"><span class="pre">c_eqnetis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqnetis_at" title="Permalink to this definition"></a></dt>
<dd><p>Net equity finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqnpo_me">
<span class="sig-name descname"><span class="pre">c_eqnpo_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqnpo_me" title="Permalink to this definition"></a></dt>
<dd><p>Net payout yield. Boudoukh et al. (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_eqpo_me">
<span class="sig-name descname"><span class="pre">c_eqpo_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_eqpo_me" title="Permalink to this definition"></a></dt>
<dd><p>Payout yield. Boudoukh et al. (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_f_score">
<span class="sig-name descname"><span class="pre">c_f_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_f_score" title="Permalink to this definition"></a></dt>
<dd><p>Piotroski F-Score (JKP). Piotroski (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_fcf_me">
<span class="sig-name descname"><span class="pre">c_fcf_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_fcf_me" title="Permalink to this definition"></a></dt>
<dd><p>Cash flow-to-price. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_fnl_gr1a">
<span class="sig-name descname"><span class="pre">c_fnl_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_fnl_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in financial liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_gp_at">
<span class="sig-name descname"><span class="pre">c_gp_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_gp_at" title="Permalink to this definition"></a></dt>
<dd><p>Gross profits-to-assets. Novy-Marx (2013)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_gp_atl1">
<span class="sig-name descname"><span class="pre">c_gp_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_gp_atl1" title="Permalink to this definition"></a></dt>
<dd><p>Gross profits-to-lagged assets. Novy-Marx (2013)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_at">
<span class="sig-name descname"><span class="pre">c_herf_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_at" title="Permalink to this definition"></a></dt>
<dd><p>Industry concentration (total assets). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_be">
<span class="sig-name descname"><span class="pre">c_herf_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_be" title="Permalink to this definition"></a></dt>
<dd><p>Industry concentration (book equity). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_herf_sale">
<span class="sig-name descname"><span class="pre">c_herf_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_herf_sale" title="Permalink to this definition"></a></dt>
<dd><p>Industry concentration (sales). Hou and Robinson (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_intrinsic_value">
<span class="sig-name descname"><span class="pre">c_intrinsic_value</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_intrinsic_value" title="Permalink to this definition"></a></dt>
<dd><p>Intrinsic value-to-market. Frankel and Lee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_inv_gr1">
<span class="sig-name descname"><span class="pre">c_inv_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_inv_gr1" title="Permalink to this definition"></a></dt>
<dd><p>Inventory growth. Belo and Lin (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_inv_gr1a">
<span class="sig-name descname"><span class="pre">c_inv_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_inv_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Inventory change. Thomas and Zhang (2002)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_invest">
<span class="sig-name descname"><span class="pre">c_invest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_invest" title="Permalink to this definition"></a></dt>
<dd><p>CAPEX and inventory. Chen and Zhang (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_kz_index">
<span class="sig-name descname"><span class="pre">c_kz_index</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_kz_index" title="Permalink to this definition"></a></dt>
<dd><p>Kaplan-Zingales Index. Lamont, Polk, and Saa-Requejo (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lgr">
<span class="sig-name descname"><span class="pre">c_lgr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lgr" title="Permalink to this definition"></a></dt>
<dd><p>Change in long-term debt. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lnoa_gr1a">
<span class="sig-name descname"><span class="pre">c_lnoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lnoa_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in long-term net operating assets. Fairfield, Whisenant, and Yohn (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_lti_gr1a">
<span class="sig-name descname"><span class="pre">c_lti_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_lti_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Chagne in long-term investments. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_mve_ia">
<span class="sig-name descname"><span class="pre">c_mve_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_mve_ia" title="Permalink to this definition"></a></dt>
<dd><p>Industry-adjusted firm size. Asness, Porter, and Stevens (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ncoa_gr1a">
<span class="sig-name descname"><span class="pre">c_ncoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ncoa_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in non-current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ncol_gr1a">
<span class="sig-name descname"><span class="pre">c_ncol_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ncol_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in non-current operating liabilities. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_netdebt_me">
<span class="sig-name descname"><span class="pre">c_netdebt_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_netdebt_me" title="Permalink to this definition"></a></dt>
<dd><p>Net debt-to-price. Penman, Richardson, and Tuna (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_netis_at">
<span class="sig-name descname"><span class="pre">c_netis_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_netis_at" title="Permalink to this definition"></a></dt>
<dd><p>Net external finance. Bradshaw, Richardson, and Sloan (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_nfna_gr1a">
<span class="sig-name descname"><span class="pre">c_nfna_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_nfna_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in net financial assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_ar1">
<span class="sig-name descname"><span class="pre">c_ni_ar1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_ar1" title="Permalink to this definition"></a></dt>
<dd><p>Earnings persistence. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_be">
<span class="sig-name descname"><span class="pre">c_ni_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_be" title="Permalink to this definition"></a></dt>
<dd><p>Return on equity. Haugen and Baker (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_ivol">
<span class="sig-name descname"><span class="pre">c_ni_ivol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_ivol" title="Permalink to this definition"></a></dt>
<dd><p>Earnings predictability. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ni_me">
<span class="sig-name descname"><span class="pre">c_ni_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ni_me" title="Permalink to this definition"></a></dt>
<dd><p>Earnings to price. Basu (1983)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_nncoa_gr1a">
<span class="sig-name descname"><span class="pre">c_nncoa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_nncoa_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in net non-current operating assets. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_noa_at">
<span class="sig-name descname"><span class="pre">c_noa_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_noa_at" title="Permalink to this definition"></a></dt>
<dd><p>Net operating assets. Hirshleifer et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_noa_gr1a">
<span class="sig-name descname"><span class="pre">c_noa_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_noa_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in net operating assets. Hirshleifer et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_o_score">
<span class="sig-name descname"><span class="pre">c_o_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_o_score" title="Permalink to this definition"></a></dt>
<dd><p>Ohlson O-Score. Dichev (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_oaccruals_at">
<span class="sig-name descname"><span class="pre">c_oaccruals_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_oaccruals_at" title="Permalink to this definition"></a></dt>
<dd><p>Operating Accruals (JKP). Sloan (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_oaccruals_ni">
<span class="sig-name descname"><span class="pre">c_oaccruals_ni</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_oaccruals_ni" title="Permalink to this definition"></a></dt>
<dd><p>Percent Operating Accruals (JKP). Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_at">
<span class="sig-name descname"><span class="pre">c_ocf_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_at" title="Permalink to this definition"></a></dt>
<dd><p>Operating cash flow to assets. Bouchard et al. (2019)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_at_chg1">
<span class="sig-name descname"><span class="pre">c_ocf_at_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_at_chg1" title="Permalink to this definition"></a></dt>
<dd><p>Change in operating cash flow to assets. Bouchard et al. (2019)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ocf_me">
<span class="sig-name descname"><span class="pre">c_ocf_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ocf_me" title="Permalink to this definition"></a></dt>
<dd><p>Operating Cash flows to price (JKP). Desai, Rajgopal, and Venkatachalam (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_op_at">
<span class="sig-name descname"><span class="pre">c_op_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_op_at" title="Permalink to this definition"></a></dt>
<dd><p>Operating profits-to-assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_op_atl1">
<span class="sig-name descname"><span class="pre">c_op_atl1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_op_atl1" title="Permalink to this definition"></a></dt>
<dd><p>Operating profits-to-lagged assets. Ball et al. (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ope_be">
<span class="sig-name descname"><span class="pre">c_ope_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ope_be" title="Permalink to this definition"></a></dt>
<dd><p>Operating profits to book equity (JKP). Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ope_bel1">
<span class="sig-name descname"><span class="pre">c_ope_bel1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ope_bel1" title="Permalink to this definition"></a></dt>
<dd><p>Operating profits to lagged book equity. Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_operprof">
<span class="sig-name descname"><span class="pre">c_operprof</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_operprof" title="Permalink to this definition"></a></dt>
<dd><p>Operating profits to book equity (GHZ, Org). Fama and French (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_opex_at">
<span class="sig-name descname"><span class="pre">c_opex_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_opex_at" title="Permalink to this definition"></a></dt>
<dd><p>Operating leverage. Novy-Marx (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchcapx_ia">
<span class="sig-name descname"><span class="pre">c_pchcapx_ia</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchcapx_ia" title="Permalink to this definition"></a></dt>
<dd><p>Industry-adjusted change in capital investment. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchcurrat">
<span class="sig-name descname"><span class="pre">c_pchcurrat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchcurrat" title="Permalink to this definition"></a></dt>
<dd><p>Change in current ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchdepr">
<span class="sig-name descname"><span class="pre">c_pchdepr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchdepr" title="Permalink to this definition"></a></dt>
<dd><p>Change in depreciation to PP&amp;E. Holthausen and Larcker (1992)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchquick">
<span class="sig-name descname"><span class="pre">c_pchquick</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchquick" title="Permalink to this definition"></a></dt>
<dd><p>Change in quick ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pchsaleinv">
<span class="sig-name descname"><span class="pre">c_pchsaleinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pchsaleinv" title="Permalink to this definition"></a></dt>
<dd><p>Change in sales to inventory. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pctacc">
<span class="sig-name descname"><span class="pre">c_pctacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pctacc" title="Permalink to this definition"></a></dt>
<dd><p>Percent operating accruals (GHZ, Org). Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_pi_nix">
<span class="sig-name descname"><span class="pre">c_pi_nix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_pi_nix" title="Permalink to this definition"></a></dt>
<dd><p>Taxable income to income (JKP). Lev and Nissim (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ppeinv_gr1a">
<span class="sig-name descname"><span class="pre">c_ppeinv_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ppeinv_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Changes in PPE and inventory/assets. Lyandres, Sun, and Zhang (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_ps">
<span class="sig-name descname"><span class="pre">c_ps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_ps" title="Permalink to this definition"></a></dt>
<dd><p>Piotroski score (GHZ, Org). Piotroski (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_quick">
<span class="sig-name descname"><span class="pre">c_quick</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_quick" title="Permalink to this definition"></a></dt>
<dd><p>Quick ratio. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd">
<span class="sig-name descname"><span class="pre">c_rd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd" title="Permalink to this definition"></a></dt>
<dd><p>Unexpected R&amp;D increase. Eberhart, Maxwell, and Siddique (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd5_at">
<span class="sig-name descname"><span class="pre">c_rd5_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd5_at" title="Permalink to this definition"></a></dt>
<dd><p>R&amp;D capital-to-assets. Li (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd_me">
<span class="sig-name descname"><span class="pre">c_rd_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd_me" title="Permalink to this definition"></a></dt>
<dd><p>R&amp;D to market. Chan, Lakonishok, and Sougiannis (Guo, Lev, and Shi (2006) in GHZ)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_rd_sale">
<span class="sig-name descname"><span class="pre">c_rd_sale</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_rd_sale" title="Permalink to this definition"></a></dt>
<dd><p>R&amp;D to sales. Chan, Lakonishok, and Sougiannis (2001) (Guo, Lev, and Shi (2006) in GHZ)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_realestate">
<span class="sig-name descname"><span class="pre">c_realestate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_realestate" title="Permalink to this definition"></a></dt>
<dd><p>Real estate holdings. Tuzel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_roic">
<span class="sig-name descname"><span class="pre">c_roic</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_roic" title="Permalink to this definition"></a></dt>
<dd><p>Return on invested capital. Brown and Rowe (2007)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_bev">
<span class="sig-name descname"><span class="pre">c_sale_bev</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_bev" title="Permalink to this definition"></a></dt>
<dd><p>Asset turnover. Soliman (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_emp_gr1">
<span class="sig-name descname"><span class="pre">c_sale_emp_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_emp_gr1" title="Permalink to this definition"></a></dt>
<dd><p>Labor force efficiency. Abarbanell and Bushee (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_gr1">
<span class="sig-name descname"><span class="pre">c_sale_gr1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_gr1" title="Permalink to this definition"></a></dt>
<dd><p>Annual sales growth. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_gr3">
<span class="sig-name descname"><span class="pre">c_sale_gr3</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_gr3" title="Permalink to this definition"></a></dt>
<dd><p>Three-year sales growth. Lakonishok, Shleifer, and Vishny (1994)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sale_me">
<span class="sig-name descname"><span class="pre">c_sale_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sale_me" title="Permalink to this definition"></a></dt>
<dd><p>Sales to price. Barbee, Mukherji, and Raines (1996)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_salecash">
<span class="sig-name descname"><span class="pre">c_salecash</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_salecash" title="Permalink to this definition"></a></dt>
<dd><p>Sales-to-cash. Ou and Penman (1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_saleinv">
<span class="sig-name descname"><span class="pre">c_saleinv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_saleinv" title="Permalink to this definition"></a></dt>
<dd><p>Sales-to-inventory. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_salerec">
<span class="sig-name descname"><span class="pre">c_salerec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_salerec" title="Permalink to this definition"></a></dt>
<dd><p>Sales-to-receivables. Ou and Penman(1989)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_secured">
<span class="sig-name descname"><span class="pre">c_secured</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_secured" title="Permalink to this definition"></a></dt>
<dd><p>Secured debt-to-total debt. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_securedind">
<span class="sig-name descname"><span class="pre">c_securedind</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_securedind" title="Permalink to this definition"></a></dt>
<dd><p>Secured debt indicator. Valta (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sin">
<span class="sig-name descname"><span class="pre">c_sin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sin" title="Permalink to this definition"></a></dt>
<dd><p>Sin stocks. Hong and Kacperczyk (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_sti_gr1a">
<span class="sig-name descname"><span class="pre">c_sti_gr1a</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_sti_gr1a" title="Permalink to this definition"></a></dt>
<dd><p>Change in short-term investments. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_taccruals_at">
<span class="sig-name descname"><span class="pre">c_taccruals_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_taccruals_at" title="Permalink to this definition"></a></dt>
<dd><p>Total Accruals. Richardson et al. (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_taccruals_ni">
<span class="sig-name descname"><span class="pre">c_taccruals_ni</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_taccruals_ni" title="Permalink to this definition"></a></dt>
<dd><p>Percent total accruals. Hafzalla, Lundholm, and Van Winkle (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_tangibility">
<span class="sig-name descname"><span class="pre">c_tangibility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_tangibility" title="Permalink to this definition"></a></dt>
<dd><p>Tangibility. Hahn and Lee (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_tb">
<span class="sig-name descname"><span class="pre">c_tb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_tb" title="Permalink to this definition"></a></dt>
<dd><p>Taxable income to income (Org, GHZ). Lev and Nissim (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.c_z_score">
<span class="sig-name descname"><span class="pre">c_z_score</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.c_z_score" title="Permalink to this definition"></a></dt>
<dd><p>Altman Z-Score. Dichev (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.convert_currency">
<span class="sig-name descname"><span class="pre">convert_currency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.convert_currency" title="Permalink to this definition"></a></dt>
<dd><p>Convert the currency of <cite>data</cite> to USD.</p>
<p>This method needs to be called if</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>the data contains non USD-denominated firms, e.g., CAD, and</p></li>
<li><p>CRSP’s market equity is used, which is always in USD.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.convert_to_monthly">
<span class="sig-name descname"><span class="pre">convert_to_monthly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.convert_to_monthly" title="Permalink to this definition"></a></dt>
<dd><p>Populate <cite>data</cite> to monthly frequency.</p>
<p>The index of <cite>data</cite> changes from datadate/gvkey to date/gvkey and datadate is kept as a column.
The date and datadate has a gap of at least <cite>lag</cite> months.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lag</strong> – Minimum months between date and datadate: <cite>lag</cite> = 4 assumes funda is available 4 months after datadate.</p></li>
<li><p><strong>limit</strong> – Maximum months to forward-fill the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Load funda data from file.</p>
<p>The loaded data is sorted on gvkey/datadate, has index = datadate/gvkey, and stored in the <cite>data</cite> attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.merge_with_fundq">
<span class="sig-name descname"><span class="pre">merge_with_fundq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fundq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.merge_with_fundq" title="Permalink to this definition"></a></dt>
<dd><p>Merge funda with fundq.</p>
<p>If variable X is available in fundq, i.e., Xq or Xy exists, Xq(y) replaces X if:</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>X is missing, or</p></li>
<li><p>Xq(y) is not missing and fundq.datadate &gt; funda.datadate.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>JKP create characteristics in funda and fundq separately and merge them, whereas we merge the raw data
first and then generate characteristics. Since some variables in funda are not available in fundq, eg, ebitda,
JKP make those unavailable variables from other variables and create characteristics, even when they are
available in funda. We prefer to merge funda with fundq at the raw data level and create characteristics from
the merged data.</p>
</div>
<p>Columns in both funda and fundq:</p>
<blockquote>
<div><p>datadate, cusip, cik, sic, naics, sale, revt, cogs, xsga, dp, xrd, ib, nopi, spi, pi, txp, ni, txt, xint,
capx, oancf, gdwlia, gdwlip, rect, act, che, ppegt, invt, at, aco, intan, ao, ppent, gdwl, lct, dlc, dltt,
lt, pstk, ap, lco, lo, drc, drlt, txdi, ceq, scstkc, csho, prcc_f, oibdp, oiadp, mii, xopr, xi, do, xido,
ibc, dpc, xidoc, fincf, fiao, txbcof, dltr, dlcch, prstkc, sstk, dv, ivao, ivst, re, txditc, txdb, seq,
mib, icapt, ajex, curcd, exratd, rcount</p>
</div></blockquote>
<p>Columns in funda but not in fundq:</p>
<blockquote>
<div><p>xad, gp, ebitda, ebit, txfed, txfo, dvt, ob, gwo, fatb, fatl, dm, dcvt, cshrc, dcpstk, emp, xlr, ds, dvc,
itcb, pstkrv, pstkl, dltis, ppenb, ppenls</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fundq</strong> – FUNDQ instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.postprocess" title="Permalink to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variables (variables starting with ‘_’) and replaces infinite values with nan.
This method can be overridden to add code to trim or winsorize characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDA.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDA.update_variables" title="Permalink to this definition"></a></dt>
<dd><p>Preprocess data before creating characteristics.</p>
<ol class="arabic simple">
<li><p>Replace missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="pyanomaly-characteristics-fundq">
<h3>pyanomaly.characteristics.FUNDQ<a class="headerlink" href="#pyanomaly-characteristics-fundq" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">FUNDQ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.panel.Panel</span></code></a></p>
<p>Class to generate firm characteristics from fundq.</p>
<p>The firm characteristics generated in this class can be viewed using <code class="docutils literal notranslate"><span class="pre">FUNDQ.show_available_functions()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FUNDQ</span><span class="p">()</span><span class="o">.</span><span class="n">show_available_functions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – Characteristic column name in <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>. If None, function names (without ‘c_’) are used as the
characteristic names.</p></li>
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY. Default to QUARTERLY.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_chtx">
<span class="sig-name descname"><span class="pre">c_chtx</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_chtx" title="Permalink to this definition"></a></dt>
<dd><p>Tax expense surprise. Thomas and Zhang (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_ni_inc8q">
<span class="sig-name descname"><span class="pre">c_ni_inc8q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_ni_inc8q" title="Permalink to this definition"></a></dt>
<dd><p>Number of consecutive quarters with earnings increases. Barth, Elliott, and Finn (1999)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_at">
<span class="sig-name descname"><span class="pre">c_niq_at</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_at" title="Permalink to this definition"></a></dt>
<dd><p>Quarterly return on assets. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_at_chg1">
<span class="sig-name descname"><span class="pre">c_niq_at_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_at_chg1" title="Permalink to this definition"></a></dt>
<dd><p>Change in quarterly return on assets. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_be">
<span class="sig-name descname"><span class="pre">c_niq_be</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_be" title="Permalink to this definition"></a></dt>
<dd><p>Return on equity (quarterly). Hou, Xue, and Zhang (2015)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_be_chg1">
<span class="sig-name descname"><span class="pre">c_niq_be_chg1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_be_chg1" title="Permalink to this definition"></a></dt>
<dd><p>Change in quarterly return on equity. Balakrishnan, Bartov, and Faurel (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_niq_su">
<span class="sig-name descname"><span class="pre">c_niq_su</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_niq_su" title="Permalink to this definition"></a></dt>
<dd><p>Earnings surprise. Foster, Olsen, and Shevlin (1984)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_ocfq_saleq_std">
<span class="sig-name descname"><span class="pre">c_ocfq_saleq_std</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_ocfq_saleq_std" title="Permalink to this definition"></a></dt>
<dd><p>Cash flow volatility. Huang (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_roavol">
<span class="sig-name descname"><span class="pre">c_roavol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_roavol" title="Permalink to this definition"></a></dt>
<dd><p>ROA volatility. Francis et al. (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_rsup">
<span class="sig-name descname"><span class="pre">c_rsup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_rsup" title="Permalink to this definition"></a></dt>
<dd><p>Revenue surprise (Karma). Kama (2009)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_saleq_su">
<span class="sig-name descname"><span class="pre">c_saleq_su</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_saleq_su" title="Permalink to this definition"></a></dt>
<dd><p>Revenue surprise. Jegadeesh and Livnat (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.c_stdacc">
<span class="sig-name descname"><span class="pre">c_stdacc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.c_stdacc" title="Permalink to this definition"></a></dt>
<dd><p>Accrual volatility. Bandyopadhyay, Huang, and Wirjanto (2010)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.convert_currency">
<span class="sig-name descname"><span class="pre">convert_currency</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.convert_currency" title="Permalink to this definition"></a></dt>
<dd><p>Convert the currency of <cite>data</cite> to USD.</p>
<p>This method needs to be called if</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>the data contains non USD-denominated firms, e.g., CAD, and</p></li>
<li><p>CRSP’s market equity is used, which is always in USD.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.convert_to_monthly">
<span class="sig-name descname"><span class="pre">convert_to_monthly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.convert_to_monthly" title="Permalink to this definition"></a></dt>
<dd><p>Populate <cite>data</cite> to monthly frequency.</p>
<p>The index of <cite>data</cite> changes from datadate/gvkey to date/gvkey and datadate is kept as a column.
The date and datadate has a gap of at least <cite>lag</cite> months.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lag</strong> – Minimum months between date and datadate: <cite>lag</cite> = 4 assumes funda is available 4 months after datadate.</p></li>
<li><p><strong>limit</strong> – Maximum months to forward-fill the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems">
<span class="sig-name descname"><span class="pre">create_qitems_from_yitems</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.create_qitems_from_yitems" title="Permalink to this definition"></a></dt>
<dd><p>Quarterize ytd items.</p>
<p>Quarterize a ytd column, Xy, and used the quarterized values to fill missing Xq if Xq exists or to
ceate a new column Xq.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.generate_funda_vars">
<span class="sig-name descname"><span class="pre">generate_funda_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.generate_funda_vars" title="Permalink to this definition"></a></dt>
<dd><p>Generate quarterly-updated annual data from fundq.</p>
<p>The output can be merged with funda using <code class="docutils literal notranslate"><span class="pre">FUNDA.merge_with_fundq()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of quarterly-updated annual data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Load fundq data from file.</p>
<p>The loaded data is sorted on gvkey/datadate, has index = datadate/gvkey, and stored in the <cite>data</cite> attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.postprocess" title="Permalink to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variables (variables starting with ‘_’) and replaces infinite values with nan.
This method can be overridden to add code to trim or winsorize characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.remove_duplicates">
<span class="sig-name descname"><span class="pre">remove_duplicates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.remove_duplicates" title="Permalink to this definition"></a></dt>
<dd><p>Drop duplicates.</p>
<p>In fundq, there are duplicate rows (rows with the same datadate and gvekey).
Remove duplicates in the following manner:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Remove records with missing fqtr.</p></li>
<li><p>Choose the latest record in the sense that it has the maximum fyearq and the minimum fqtr.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.FUNDQ.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.FUNDQ.update_variables" title="Permalink to this definition"></a></dt>
<dd><p>Preprocess data before creating characteristics.</p>
<ol class="arabic simple">
<li><p>Replace missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="pyanomaly-characteristics-crspm">
<h3>pyanomaly.characteristics.CRSPM<a class="headerlink" href="#pyanomaly-characteristics-crspm" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">CRSPM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.panel.Panel</span></code></a></p>
<p>Class to generate firm characteristics from crspm.</p>
<p>The firm characteristics generated in this class can be viewed using <code class="docutils literal notranslate"><span class="pre">CRSPM.show_available_functions()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CRSPM</span><span class="p">()</span><span class="o">.</span><span class="n">show_available_functions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – Characteristic column name in <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>. If None, function names (without ‘c_’) are used as the
characteristic names.</p></li>
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY. Default to MONTHLY.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_beta_60m">
<span class="sig-name descname"><span class="pre">c_beta_60m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_beta_60m" title="Permalink to this definition"></a></dt>
<dd><p>Market beta (Org, JKP). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_chcsho_12m">
<span class="sig-name descname"><span class="pre">c_chcsho_12m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_chcsho_12m" title="Permalink to this definition"></a></dt>
<dd><p>Net stock issues (JKP). Pontiff and Woodgate (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_chmom">
<span class="sig-name descname"><span class="pre">c_chmom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_chmom" title="Permalink to this definition"></a></dt>
<dd><p>Change in 6-month momentum. Gettleman and Marks (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_div12m_me">
<span class="sig-name descname"><span class="pre">c_div12m_me</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_div12m_me" title="Permalink to this definition"></a></dt>
<dd><p>Dividend yield (JKP). Litzenberger and Ramaswamy (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_divi">
<span class="sig-name descname"><span class="pre">c_divi</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_divi" title="Permalink to this definition"></a></dt>
<dd><p>Dividend initiation. Michaely, Thaler, and Womack (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_divo">
<span class="sig-name descname"><span class="pre">c_divo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_divo" title="Permalink to this definition"></a></dt>
<dd><p>Dividend omission. Michaely, Thaler, and Womack (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_dolvol">
<span class="sig-name descname"><span class="pre">c_dolvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_dolvol" title="Permalink to this definition"></a></dt>
<dd><p>Dollar trading volume (Org, GHZ). Brennan, Chordia, and Subrahmanyam (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_eqnpo_12m">
<span class="sig-name descname"><span class="pre">c_eqnpo_12m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_eqnpo_12m" title="Permalink to this definition"></a></dt>
<dd><p>Composite equity issuance (JKP, 12 months). Daniel and Titman (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_eqnpo_60m">
<span class="sig-name descname"><span class="pre">c_eqnpo_60m</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_eqnpo_60m" title="Permalink to this definition"></a></dt>
<dd><p>Composite equity issuance (Org). Daniel and Titman (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_indmom">
<span class="sig-name descname"><span class="pre">c_indmom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_indmom" title="Permalink to this definition"></a></dt>
<dd><p>Industry momentum. Moskowitz and Grinblatt (1999)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ipo">
<span class="sig-name descname"><span class="pre">c_ipo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ipo" title="Permalink to this definition"></a></dt>
<dd><p>Initial public offerings. Loughran and Ritter (1995)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_market_equity">
<span class="sig-name descname"><span class="pre">c_market_equity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_market_equity" title="Permalink to this definition"></a></dt>
<dd><p>Market equity. Banz (1981)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_price">
<span class="sig-name descname"><span class="pre">c_price</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_price" title="Permalink to this definition"></a></dt>
<dd><p>Share price. Miller and Scholes (1982)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_resff3_12_1">
<span class="sig-name descname"><span class="pre">c_resff3_12_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_resff3_12_1" title="Permalink to this definition"></a></dt>
<dd><p>12 month residual momentum. Blitz, Huij, and Martens (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_resff3_6_1">
<span class="sig-name descname"><span class="pre">c_resff3_6_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_resff3_6_1" title="Permalink to this definition"></a></dt>
<dd><p>6 month residual momentum. Blitz, Huij, and Martens (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_12_1">
<span class="sig-name descname"><span class="pre">c_ret_12_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_12_1" title="Permalink to this definition"></a></dt>
<dd><p>Momentum (12 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_12_6">
<span class="sig-name descname"><span class="pre">c_ret_12_6</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_12_6" title="Permalink to this definition"></a></dt>
<dd><p>Intermediate momentum (7-12). Novy-Marx (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_1_0">
<span class="sig-name descname"><span class="pre">c_ret_1_0</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_1_0" title="Permalink to this definition"></a></dt>
<dd><p>Short-term reversal. Jegadeesh (1990)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_36_12">
<span class="sig-name descname"><span class="pre">c_ret_36_12</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_36_12" title="Permalink to this definition"></a></dt>
<dd><p>Long-term reversal (12-36). De Bondt and Thaler (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_3_1">
<span class="sig-name descname"><span class="pre">c_ret_3_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_3_1" title="Permalink to this definition"></a></dt>
<dd><p>Momentum (3 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_60_12">
<span class="sig-name descname"><span class="pre">c_ret_60_12</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_60_12" title="Permalink to this definition"></a></dt>
<dd><p>Long-term reversal (12-60). De Bondt and Thaler (1985)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_6_1">
<span class="sig-name descname"><span class="pre">c_ret_6_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_6_1" title="Permalink to this definition"></a></dt>
<dd><p>Momentum (6 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_ret_9_1">
<span class="sig-name descname"><span class="pre">c_ret_9_1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_ret_9_1" title="Permalink to this definition"></a></dt>
<dd><p>Momentum (9 months). Jegadeesh and Titman (1993)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_11_15an">
<span class="sig-name descname"><span class="pre">c_seas_11_15an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_11_15an" title="Permalink to this definition"></a></dt>
<dd><p>Years 11-15 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_11_15na">
<span class="sig-name descname"><span class="pre">c_seas_11_15na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_11_15na" title="Permalink to this definition"></a></dt>
<dd><p>Years 11-15 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_16_20an">
<span class="sig-name descname"><span class="pre">c_seas_16_20an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_16_20an" title="Permalink to this definition"></a></dt>
<dd><p>Years 16-20 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_16_20na">
<span class="sig-name descname"><span class="pre">c_seas_16_20na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_16_20na" title="Permalink to this definition"></a></dt>
<dd><p>Years 16-20 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_1_1an">
<span class="sig-name descname"><span class="pre">c_seas_1_1an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_1_1an" title="Permalink to this definition"></a></dt>
<dd><p>Year 1-lagged return, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_1_1na">
<span class="sig-name descname"><span class="pre">c_seas_1_1na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_1_1na" title="Permalink to this definition"></a></dt>
<dd><p>Year 1-lagged return, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_2_5an">
<span class="sig-name descname"><span class="pre">c_seas_2_5an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_2_5an" title="Permalink to this definition"></a></dt>
<dd><p>Years 2-5 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_2_5na">
<span class="sig-name descname"><span class="pre">c_seas_2_5na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_2_5na" title="Permalink to this definition"></a></dt>
<dd><p>Years 2-5 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_6_10an">
<span class="sig-name descname"><span class="pre">c_seas_6_10an</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_6_10an" title="Permalink to this definition"></a></dt>
<dd><p>Years 6-10 lagged returns, annual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_seas_6_10na">
<span class="sig-name descname"><span class="pre">c_seas_6_10na</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_seas_6_10na" title="Permalink to this definition"></a></dt>
<dd><p>Years 6-10 lagged returns, nonannual. Heston and Sadka (2008)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.c_turn">
<span class="sig-name descname"><span class="pre">c_turn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.c_turn" title="Permalink to this definition"></a></dt>
<dd><p>Share turnover (Org, GHZ). Datar, Naik, and Radcliffe (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.filter_data">
<span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.filter_data" title="Permalink to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>Currently, we filter data only on <cite>shrcd</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Load crspm data from file.</p>
<p>The loaded data is sorted on permno/date, has index = date/permno, and stored in the <cite>data</cite> attribute.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In CRSP monthly tables, date is the last business day of the month, whereas datadate in Compustat is the
end-of-month date. To make the two dates consistent, crspm.date is shifted to the end of the month.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.merge_with_factors">
<span class="sig-name descname"><span class="pre">merge_with_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.merge_with_factors" title="Permalink to this definition"></a></dt>
<dd><p>Merge crspm with factors.</p>
<p>The <cite>factors</cite> should contain Fama-French 3 factors with column names as defined in config.factor_names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factors</strong> – DataFrame of factors with index = date. If None, it will be read from config.monthly_factors_fname.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.postprocess" title="Permalink to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variables (variables starting with ‘_’) and replaces infinite values with nan.
This method can be overridden to add code to trim or winsorize characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPM.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPM.update_variables" title="Permalink to this definition"></a></dt>
<dd><p>Preprocess data before creating characteristics.</p>
<ol class="arabic simple">
<li><p>Replace missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="pyanomaly-characteristics-crspd">
<h3>pyanomaly.characteristics.CRSPD<a class="headerlink" href="#pyanomaly-characteristics-crspd" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">CRSPD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">365</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.panel.Panel</span></code></a></p>
<p>Class to generate firm characteristics from crspd.</p>
<p>CRSPD generates firm characteristics monthly and store them in the <cite>chars</cite> attribute instead of the <cite>data</cite>
attribute, which is a daily data.</p>
<p>The firm characteristics generated in this class can be viewed using <code class="docutils literal notranslate"><span class="pre">CRSPD.show_available_functions()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">CRSPD</span><span class="p">()</span><span class="o">.</span><span class="n">show_available_functions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – Characteristic column name in <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>. If None, function names (without ‘c_’) are used as the
characteristic names.</p></li>
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY. Default to DAILY.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.chars">
<span class="sig-name descname"><span class="pre">chars</span></span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.chars" title="Permalink to this definition"></a></dt>
<dd><p>DataFrame to store firm characteristics. Index = date/permno.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ami_126d">
<span class="sig-name descname"><span class="pre">c_ami_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ami_126d" title="Permalink to this definition"></a></dt>
<dd><p>Illiquidity. Amihud (2002)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_baspread">
<span class="sig-name descname"><span class="pre">c_baspread</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_baspread" title="Permalink to this definition"></a></dt>
<dd><p>Bid-ask spread. Amihud and Mendelson (1986)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_beta">
<span class="sig-name descname"><span class="pre">c_beta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_beta" title="Permalink to this definition"></a></dt>
<dd><p>Market beta  (GHZ). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_beta_dimson_21d">
<span class="sig-name descname"><span class="pre">c_beta_dimson_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_beta_dimson_21d" title="Permalink to this definition"></a></dt>
<dd><p>Dimson Beta. Dimson (1979)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betabab_1260d">
<span class="sig-name descname"><span class="pre">c_betabab_1260d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betabab_1260d" title="Permalink to this definition"></a></dt>
<dd><p>Frazzini-Pedersen beta. Frazzini and Pedersen (2014)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betadown_252d">
<span class="sig-name descname"><span class="pre">c_betadown_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betadown_252d" title="Permalink to this definition"></a></dt>
<dd><p>Downside beta. Ang, Chen, and Xing (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_betasq">
<span class="sig-name descname"><span class="pre">c_betasq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_betasq" title="Permalink to this definition"></a></dt>
<dd><p>Beta squared (GHZ). Fama and MacBeth (1973)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_bidaskhl_21d">
<span class="sig-name descname"><span class="pre">c_bidaskhl_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_bidaskhl_21d" title="Permalink to this definition"></a></dt>
<dd><p>High-low bid-ask spread. Corwin and Schultz (2012)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_corr_1260d">
<span class="sig-name descname"><span class="pre">c_corr_1260d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_corr_1260d" title="Permalink to this definition"></a></dt>
<dd><p>Market correlation. Assness et al. (2020)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_coskew_21d">
<span class="sig-name descname"><span class="pre">c_coskew_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_coskew_21d" title="Permalink to this definition"></a></dt>
<dd><p>Coskewness. Harvey and Siddique (2000)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_dolvol_126d">
<span class="sig-name descname"><span class="pre">c_dolvol_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_dolvol_126d" title="Permalink to this definition"></a></dt>
<dd><p>Dollar trading volume (JKP). Brennan, Chordia, and Subrahmanyam (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_dolvol_var_126d">
<span class="sig-name descname"><span class="pre">c_dolvol_var_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_dolvol_var_126d" title="Permalink to this definition"></a></dt>
<dd><p>Volatility of dollar trading volume (JKP). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_idiovol">
<span class="sig-name descname"><span class="pre">c_idiovol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_idiovol" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (GHZ). Ali, Hwang, and Trombley (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_capm_21d">
<span class="sig-name descname"><span class="pre">c_iskew_capm_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_capm_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (CAPM). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_ff3_21d">
<span class="sig-name descname"><span class="pre">c_iskew_ff3_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_ff3_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (FF3). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_iskew_hxz4_21d">
<span class="sig-name descname"><span class="pre">c_iskew_hxz4_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_iskew_hxz4_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic skewness (HXZ). Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_capm_21d">
<span class="sig-name descname"><span class="pre">c_ivol_capm_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_capm_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (CAPM). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_capm_252d">
<span class="sig-name descname"><span class="pre">c_ivol_capm_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_capm_252d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (Org, JKP). Ali, Hwang, and Trombley (2003)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_ff3_21d">
<span class="sig-name descname"><span class="pre">c_ivol_ff3_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_ff3_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (FF3). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_ivol_hxz4_21d">
<span class="sig-name descname"><span class="pre">c_ivol_hxz4_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_ivol_hxz4_21d" title="Permalink to this definition"></a></dt>
<dd><p>Idiosyncratic volatility (HXZ). Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_prc_highprc_252d">
<span class="sig-name descname"><span class="pre">c_prc_highprc_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_prc_highprc_252d" title="Permalink to this definition"></a></dt>
<dd><p>52-week high. George and Hwang (2004)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_pricedelay">
<span class="sig-name descname"><span class="pre">c_pricedelay</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_pricedelay" title="Permalink to this definition"></a></dt>
<dd><p>Price delay based on R-squared. Hou and Moskowitz (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_pricedelay_slope">
<span class="sig-name descname"><span class="pre">c_pricedelay_slope</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_pricedelay_slope" title="Permalink to this definition"></a></dt>
<dd><p>Price delay based on slopes. Hou and Moskowitz (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_retvol">
<span class="sig-name descname"><span class="pre">c_retvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_retvol" title="Permalink to this definition"></a></dt>
<dd><p>Return volatility. Ang et al. (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax1_21d">
<span class="sig-name descname"><span class="pre">c_rmax1_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax1_21d" title="Permalink to this definition"></a></dt>
<dd><p>Maximum daily return. Bali, Cakici, and Whitelaw (2011)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax5_21d">
<span class="sig-name descname"><span class="pre">c_rmax5_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax5_21d" title="Permalink to this definition"></a></dt>
<dd><p>Highest 5 days of return. Bali, Brown, and Tang (2017)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rmax5_rvol_21d">
<span class="sig-name descname"><span class="pre">c_rmax5_rvol_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rmax5_rvol_21d" title="Permalink to this definition"></a></dt>
<dd><p>Highest 5 days of return to volatility. Assness et al. (2020)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_rskew_21d">
<span class="sig-name descname"><span class="pre">c_rskew_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_rskew_21d" title="Permalink to this definition"></a></dt>
<dd><p>Return skewness. Bali, Engle, and Murray (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_std_dolvol">
<span class="sig-name descname"><span class="pre">c_std_dolvol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_std_dolvol" title="Permalink to this definition"></a></dt>
<dd><p>Volatility of dollar trading volume (GHZ). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_std_turn">
<span class="sig-name descname"><span class="pre">c_std_turn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_std_turn" title="Permalink to this definition"></a></dt>
<dd><p>Volatility of share turnover (GHZ). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_turnover_126d">
<span class="sig-name descname"><span class="pre">c_turnover_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_turnover_126d" title="Permalink to this definition"></a></dt>
<dd><p>Share turnover (JKP). Datar, Naik, and Radcliffe (1998)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_turnover_var_126d">
<span class="sig-name descname"><span class="pre">c_turnover_var_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_turnover_var_126d" title="Permalink to this definition"></a></dt>
<dd><p>Volatility of share turnover (JKP). Chordia, Subrahmanyam, and Anshuman (2001)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_126d">
<span class="sig-name descname"><span class="pre">c_zero_trades_126d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_126d" title="Permalink to this definition"></a></dt>
<dd><p>Zero-trading days (6 months). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_21d">
<span class="sig-name descname"><span class="pre">c_zero_trades_21d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_21d" title="Permalink to this definition"></a></dt>
<dd><p>Zero-trading days (1 month). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.c_zero_trades_252d">
<span class="sig-name descname"><span class="pre">c_zero_trades_252d</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.c_zero_trades_252d" title="Permalink to this definition"></a></dt>
<dd><p>Zero-trading days (12 months). Liu (2006)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.create_chars">
<span class="sig-name descname"><span class="pre">create_chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.create_chars" title="Permalink to this definition"></a></dt>
<dd><p>Generate firm characteristics.</p>
<p>This method overrides <code class="docutils literal notranslate"><span class="pre">Panel.create_chars()</span></code> to store characteristics in <cite>chars</cite> instead of <cite>data</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.filter_data">
<span class="sig-name descname"><span class="pre">filter_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.filter_data" title="Permalink to this definition"></a></dt>
<dd><p>Filter data.</p>
<p>Currently, we filter data only on <cite>shrcd</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.load" title="Permalink to this definition"></a></dt>
<dd><p>Load data and parameters.</p>
<p>This method overrides <code class="docutils literal notranslate"><span class="pre">Panel.load()</span></code> to load <cite>chars</cite> instead of <cite>data</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.load_data">
<span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.load_data" title="Permalink to this definition"></a></dt>
<dd><p>Load crspd data from file.</p>
<p>The loaded data is sorted on permno/date, has index = date/permno, and stored in the <cite>data</cite> attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.merge_with_factors">
<span class="sig-name descname"><span class="pre">merge_with_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.merge_with_factors" title="Permalink to this definition"></a></dt>
<dd><p>Merge crspd with factors.</p>
<p>The <cite>factors</cite> should contain Fama-French 3 factors and Hou-Xue-Zhang 4 factors with column names as defined
in config.factor_names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factors</strong> – DataFrame of factors with index = date. If None, it will be read from config.daily_factors_fname.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.postprocess" title="Permalink to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variables (variables starting with ‘_’) and replaces infinite values with nan.
This method can be overridden to add code to trim or winsorize characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_fcns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.prepare" title="Permalink to this definition"></a></dt>
<dd><p>Prepare “ingredient” characteristics that are required to generate a characteristic.</p>
<p>This method overrides <code class="docutils literal notranslate"><span class="pre">Panel.prepare()</span></code> to store characteristics in <cite>chars</cite> instead of <cite>data</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.rolling_apply_m">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rolling_apply_m</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_retval</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.rolling_apply_m" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>fcn</cite> to <cite>cd[data_columns]</cite> in every month for each stock.</p>
<p>This function runs a loop over permno-month and can be used when the calculation
inside <cite>fcn</cite> requires only the data within the month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cd</strong> – <cite>crspd.data</cite>.</p></li>
<li><p><strong>data_columns</strong> – Columns of <cite>cd</cite> that are used as input to <cite>fcn</cite>.</p></li>
<li><p><strong>fcn</strong> – function to apply. The first argument (<cite>data</cite>) should be <cite>cd[data_columns]</cite> of a permno-month and
the second argument (<cite>isnan</cite>) should be a nan indicator of <cite>data</cite>:
<cite>isnan[i]</cite> = True if any column of data[i, :] has nan. <cite>fcn</cite> should return a tuple of size <cite>n_retval</cite>.</p></li>
<li><p><strong>n_retval</strong> – Number of returns from fcn.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated ndarray of the returns from <cite>fcn</cite>. Size = permno/month x n_retval.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.save" title="Permalink to this definition"></a></dt>
<dd><p>Save this object.</p>
<p>This method overrides <code class="docutils literal notranslate"><span class="pre">Panel.save()</span></code> to save <cite>chars</cite> instead of <cite>data</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.CRSPD.update_variables">
<span class="sig-name descname"><span class="pre">update_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.CRSPD.update_variables" title="Permalink to this definition"></a></dt>
<dd><p>Preprocess data before creating characteristics.</p>
<ol class="arabic simple">
<li><p>Replace missing values with other variables.</p></li>
<li><p>Create frequently used variables.</p></li>
</ol>
</dd></dl>

</dd></dl>

</section>
<section id="pyanomaly-characteristics-merge">
<h3>pyanomaly.characteristics.Merge<a class="headerlink" href="#pyanomaly-characteristics-merge" title="Permalink to this headline"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.characteristics.</span></span><span class="sig-name descname"><span class="pre">Merge</span></span><a class="headerlink" href="#pyanomaly.characteristics.Merge" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.panel.Panel" title="pyanomaly.panel.Panel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.panel.Panel</span></code></a></p>
<p>Class to generate firm characteristics from a merged dataset of funda, fundq, crspm, and crspd.</p>
<p>The firm characteristics generated in this class can be viewed using <code class="docutils literal notranslate"><span class="pre">Merge.show_available_functions()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Merge</span><span class="p">()</span><span class="o">.</span><span class="n">show_available_functions</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_age">
<span class="sig-name descname"><span class="pre">c_age</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_age" title="Permalink to this definition"></a></dt>
<dd><p>Firm age. Jiang, Lee, and Zhang (2005)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_mispricing_mgmt">
<span class="sig-name descname"><span class="pre">c_mispricing_mgmt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_mispricing_mgmt" title="Permalink to this definition"></a></dt>
<dd><p>Mispricing factor: Management. Stambaugh and Yuan (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_mispricing_perf">
<span class="sig-name descname"><span class="pre">c_mispricing_perf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_mispricing_perf" title="Permalink to this definition"></a></dt>
<dd><p>Mispricing factor: Performance. Stambaugh and Yuan (2016)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj">
<span class="sig-name descname"><span class="pre">c_qmj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj" title="Permalink to this definition"></a></dt>
<dd><p>Quality minus Junk: Composite. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_growth">
<span class="sig-name descname"><span class="pre">c_qmj_growth</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_growth" title="Permalink to this definition"></a></dt>
<dd><p>Quality minus Junk: Growth. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_prof">
<span class="sig-name descname"><span class="pre">c_qmj_prof</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_prof" title="Permalink to this definition"></a></dt>
<dd><p>Quality minus Junk: Profitability. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.c_qmj_safety">
<span class="sig-name descname"><span class="pre">c_qmj_safety</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.c_qmj_safety" title="Permalink to this definition"></a></dt>
<dd><p>Quality minus Junk: Safety. Assness, Frazzini, and Pedersen (2018)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.postprocess">
<span class="sig-name descname"><span class="pre">postprocess</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.postprocess" title="Permalink to this definition"></a></dt>
<dd><p>Postprocess data.</p>
<p>This method deletes temporary variables (variables starting with ‘_’) and replaces infinite values with nan.
This method can be overridden to add code to trim or winsorize characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.characteristics.Merge.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crspm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crspd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">funda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fundq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.characteristics.Merge.preprocess" title="Permalink to this definition"></a></dt>
<dd><p>Merge crspm, crspd, funda, and fundq by left-joining crspd, funda, and fundq to crspm. The resulting data has
index = date/permno.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crspm</strong> – CRSPM instance</p></li>
<li><p><strong>crspd</strong> – CRSPD instance</p></li>
<li><p><strong>funda</strong> – FUNDA instance</p></li>
<li><p><strong>fundq</strong> – FUNDQ instance</p></li>
<li><p><strong>delete_data</strong> – True to delete the data of crspm, crspd, funda, and fundq after merge to save memory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-pyanomaly.datatools">
<span id="pyanomaly-datatools"></span><h2>pyanomaly.datatools<a class="headerlink" href="#module-pyanomaly.datatools" title="Permalink to this headline"></a></h2>
<p>This module defines various toolkits for data-handling.</p>
<dl class="simple">
<dt>Rolling Application of Function</dt><dd><p>The functions below apply a function to each group of a grouped data. For the differences,
see the documentation of each function.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">groupby_apply()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">groupby_apply_np()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rolling_apply()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rolling_apply_np()</span></code></p></li>
</ul>
</dd>
<dt>Grouping/Filtering/Trimming/Winsorization</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">classify()</span></code>: Classify data cross-sectionally.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter_n()</span></code>: Filter data on a column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter()</span></code>: Filter data on a column with cut points based on another column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trim()</span></code>: Trim data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">winsorize()</span></code>: Winsorize data.</p></li>
</ul>
</dd>
<dt>Data Inspection/Comparison</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inspect_data()</span></code>: Inspect a dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compare_data()</span></code>: Compare two data sets.</p></li>
</ul>
</dd>
<dt>Auxiliary Functions</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">populate()</span></code>: Populate data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_month_end()</span></code>: Shift dates to the last dates of the same month.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_months()</span></code>: Add months to dates.</p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.add_months">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">add_months</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">months</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_month_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.add_months" title="Permalink to this definition"></a></dt>
<dd><p>Add months to dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> – datetime Series.</p></li>
<li><p><strong>months</strong> – Months to add. Can be negative.</p></li>
<li><p><strong>to_month_end</strong> – If True, returned dates are end-of-month dates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>datetime Series of (<cite>date</cite> + <cite>months</cite>). Dates are end-of-month dates if <cite>to_month_end</cite> = True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.classify">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.classify" title="Permalink to this definition"></a></dt>
<dd><p>Classify <cite>array</cite> cross-sectionally.</p>
<p>Class labels are set to 0, …, no. quantiles-1, where 0 corresponds to the lowest (highest) group
if <cite>ascending</cite> = True (False). If <cite>array</cite> contains nan, their classes are set to nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Data to classify. Series with date/id index.</p></li>
<li><p><strong>split</strong> – Number of classes or list of quantiles (see <cite>classify_array()</cite>).</p></li>
<li><p><strong>ascending</strong> (<em>bool</em>) – Sorting order.</p></li>
<li><p><strong>by_array</strong> – Data based on which quantile breakpoints are determined. If None, <cite>by_array</cite> = <cite>array</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of class labels with index = <cite>data.index</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Suppose <cite>data</cite> is a panel data that has columns ‘me’ (market equity) and ‘me_nyse’ (same as ‘me’ but
has a value only when the stock is listed on NYSE).
The following code groups stocks into terciles based on size with NYSE-size breakpoints and store the output
in <cite>data[‘me_class’]</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># bottom 20%, 20-70%, top 30%</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;me_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">],</span> <span class="n">split</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;me_nyse&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.classify_array">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">classify_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.classify_array" title="Permalink to this definition"></a></dt>
<dd><p>Classify array into classes.</p>
<p>Class labels are set to 0, …, no. quantiles-1, where 0 corresponds to the lowest (highest) group
if <cite>ascending</cite> = True (False).
If array contains nan, their classes are set to nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Nx1 ndarray or Series to be grouped.</p></li>
<li><p><strong>split</strong> – Number of classes (for equal-size quantiles) or list of quantiles. (0.3, 0.7) is equivalent to (0.3, 0.7, 1.0).</p></li>
<li><p><strong>ascending</strong> (<em>bool</em>) – Sorting order.</p></li>
<li><p><strong>by_array</strong> – Array based on which cut points are determined. If None, by_array = array. Eg, array can be set
to ME and by_array to NYSE-ME to group firms on size with NYSE-size cut points.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nx1 ndarray or Series of classes. The output type corresponds to the input type.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">split</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Classify array into 10 equally-spaced groups (0, ..., 9).</span>
<span class="n">split</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>  <span class="c1"># Classify array into three groups (0, 1, 2) that correspond to 0.3, 03-0.7, 0.7-1.0</span>
                         <span class="c1"># quantiles.</span>
<span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Label 0 represents the largest group.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.compare_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">compare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('_x',</span> <span class="pre">'_y')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.compare_data" title="Permalink to this definition"></a></dt>
<dd><p>Compare <cite>data1</cite> with <cite>data2</cite>.</p>
<p>This function compares the common columns of <cite>data1</cite> and <cite>data2</cite>.
This is similar to <code class="docutils literal notranslate"><span class="pre">data1.compare(data2)</span></code>, but <cite>data1</cite> and <cite>data2</cite> are not required to have the same index and
columns. Also, a tolerance can be set to determine whether two values are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> – Dataframe for comparison.</p></li>
<li><p><strong>data2</strong> – Dataframe for comparison. If None, <cite>data1</cite> is assumed to be a merged dataset of <cite>data1</cite> and <cite>data2</cite>.
If <cite>data1</cite> is a merged dataset, <cite>on</cite> and <cite>how</cite> have no effect.</p></li>
<li><p><strong>on</strong> – A column or a list of columns to merge data sets on. If None, data sets will be merged on index.</p></li>
<li><p><strong>how</strong> – How to merge: ‘inner’, ‘outer’, ‘left’, or ‘right’</p></li>
<li><p><strong>tolerance</strong> – Tolerance level to determine equality. Two values, <cite>val1</cite> and <cite>val2</cite>, are considered to be the same
if <cite>abs((val1 - val2) / val2) &lt; tolerance</cite>.</p></li>
<li><p><strong>suffixes</strong> – suffixes to add to common columns or suffixes used in the merged dataset.
<cite>suffixes[0]</cite>: suffix for <cite>data1</cite>, <cite>suffixes[1]</cite>: suffix for <cite>data2</cite>.</p></li>
<li><p><strong>returns</strong> – If True, return the merged data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.filter">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.filter" title="Permalink to this definition"></a></dt>
<dd><p>Filter <cite>data</cite> on <cite>on</cite> with cut points determined by <cite>by</cite>.</p>
<p>Filter out data if <cite>data[on]</cite> is below <cite>limits[0]</cite> quantile or above (1 - <cite>limits[1]</cite>) quantile.
This function is similar to <code class="docutils literal notranslate"><span class="pre">filter_n()</span></code> but the cut points can be determined by another column values instead
of the values of <cite>on</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame or Series. The first index should be date.</p></li>
<li><p><strong>on</strong> – Column to filter on.</p></li>
<li><p><strong>limits</strong> – Pair of quantiles, eg, (0.1, 0.1), (0.1, None).</p></li>
<li><p><strong>by</strong> – Column based on which cut points are determined. If None, <cite>by</cite> = <cite>col</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filtered data.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Suppose <cite>data</cite> is a panel data (index = date/id) and has columns ‘me’ (market equity) and ‘nyse_me’
(market equity of NYSE stocks). The stocks whose sizes are smaller than the 0.2 NYSE-size quantile can be
removed as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">by</span><span class="o">=</span><span class="s1">&#39;nyse_me&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.filter_n">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">filter_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.filter_n" title="Permalink to this definition"></a></dt>
<dd><p>Filter <cite>data</cite> on <cite>on</cite>.</p>
<p>If <cite>n</cite> is given, choose <cite>n</cite> smallest (if <cite>ascending</cite> = True) or largest (if <cite>ascending</cite> = False) within
each date. If <cite>q</cite> is given, choose <cite>q</cite> quantile (from the bottom if <cite>ascending</cite> = True) within each date.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame or Series. The first index should be date.</p></li>
<li><p><strong>on</strong> – Column to filter on.</p></li>
<li><p><strong>n</strong> – Number of rows to keep.</p></li>
<li><p><strong>q</strong> – Quantile to keep.</p></li>
<li><p><strong>ascending</strong> (<em>bool</em>) – If True, keep the smallest.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filtered data.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Suppose <cite>data</cite> is a panel data (index = date/id) and has a column ‘me’ (market equity).
The smallest 20% can be filtered out (keep the largest 80%) as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.groupby_apply">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">groupby_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.groupby_apply" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>fcn</cite> to groups in <cite>gb</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gb</strong> – pd.GroupBy object.</p></li>
<li><p><strong>fcn</strong> – Function to apply to groups. Function arguments should be <cite>(gbdata, *args)</cite>,
where <cite>gbdata</cite> is an element of <cite>gb</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated outputs of <cite>fcn</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.groupby_apply_np">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">groupby_apply_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.groupby_apply_np" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>fcn</cite> to the values of the groups in <cite>gb</cite>.</p>
<p>This is the same as <code class="docutils literal notranslate"><span class="pre">groupby_apply()</span></code> except that the first argument of <cite>fcn</cite> is the values of the grouped data
(ndarray). Use this function if <cite>fcn</cite> cannot receive DataFrame as an argument, e.g., when <cite>fcn</cite> is wrapped by
<code class="docutils literal notranslate"><span class="pre">numpy.jit</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The groupby operation must not change the order of the data as the input to <cite>fcn</cite>, <cite>data.values</cite>, does not
have an index. E.g., if <cite>data</cite> is sorted on <cite>id</cite>/<cite>date</cite>, grouping <cite>data</cite> by <cite>id</cite> is fine but not by <cite>date</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gb</strong> – pd.GroupBy object.</p></li>
<li><p><strong>fcn</strong> – Function to apply to groups. Function arguments should be <cite>(gbdata_values, *args)</cite>,
where <cite>gbdata_values</cite> is the values of an element of <cite>gb</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated outputs of <cite>fcn</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.inspect_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">inspect_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['summary']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.inspect_data" title="Permalink to this definition"></a></dt>
<dd><p>Inspect data.</p>
<p>This function inspects a panel data, <cite>data</cite>, and print the results.</p>
<ul class="simple">
<li><p>‘summary’: <cite>data</cite> shape, number of unique dates, and number of unique ids.</p></li>
<li><p>‘id_count`: Number of ids per date.</p></li>
<li><p>‘nans’: Number of nans and infs per column.</p></li>
<li><p>‘stats’: Descriptive statistics. Same as <code class="docutils literal notranslate"><span class="pre">data.describe()</span></code>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataframe. It should have date and id columns or index = date/id.</p></li>
<li><p><strong>option</strong> – List of items to display. Available options:
‘summary’, ‘id_count’, ‘nans’, ‘stats’.</p></li>
<li><p><strong>date_col</strong> – Date column. If None, <cite>date.index[0]</cite> is assumed to be date.</p></li>
<li><p><strong>id_col</strong> – ID column. If None, <cite>date.index[1]</cite> is assumed to be id.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.populate">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">populate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ffill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.populate" title="Permalink to this definition"></a></dt>
<dd><p>Populate data.</p>
<p class="rubric">References</p>
<p><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.resample.html">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.resample.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataframe with index = date/id.</p></li>
<li><p><strong>freq</strong> – Frequency to populate: QUARTERLY, MONTHLY, or DAILY.</p></li>
<li><p><strong>method</strong> – Filling method for newly added rows. ‘ffill’: forward fill, None: None.</p></li>
<li><p><strong>limit</strong> – Maximum number of rows to forward-fill.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Populated data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.rolling_apply">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">rolling_apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.rolling_apply" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>fcn</cite> to each group of data grouped by <cite>by</cite>.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">groupby_apply()</span></code>: <code class="docutils literal notranslate"><span class="pre">groupby_apply()</span></code> receives pd.GroupBy object as input whereas this
function performs <code class="docutils literal notranslate"><span class="pre">pd.groupby()</span></code> inside.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be grouped.</p></li>
<li><p><strong>by</strong> – Column by which <cite>data</cite> is grouped. If None, <cite>data</cite> is grouped by the last index.</p></li>
<li><p><strong>fcn</strong> – Function to apply to groups.  Function arguments should be <cite>(gbdata, *args)</cite>,
where <cite>gbdata</cite> is an element of the grouped data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated outputs of <cite>fcn</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.rolling_apply_np">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">rolling_apply_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.rolling_apply_np" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>fcn</cite> to each group of data grouped by <cite>by</cite>.</p>
<p>This is the same as <code class="docutils literal notranslate"><span class="pre">rolling_apply()</span></code> except that the first argument of <cite>fcn</cite> is the values of the grouped data
(ndarray). Use this function if <cite>fcn</cite> cannot receive DataFrame as an argument, e.g., when <cite>fcn</cite> is wrapped by
<code class="docutils literal notranslate"><span class="pre">numpy.jit</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The groupby operation must not change the order of the data as the input to <cite>fcn</cite>, <cite>data.values</cite>, does not
have an index. E.g., if <cite>data</cite> is sorted on <cite>id</cite>/<cite>date</cite>, grouping <cite>data</cite> by <cite>id</cite> is fine but not by <cite>date</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame to be grouped.</p></li>
<li><p><strong>by</strong> – Column by which <cite>data</cite> is grouped. If None, <cite>data</cite> is grouped by the last index, i.e., groupby(level=-1).</p></li>
<li><p><strong>fcn</strong> – Function to apply to groups. Function arguments should be <cite>(gbdata_values, *args)</cite>,
where <cite>gbdata_values</cite> is the values of an element of the grouped data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated outputs of <cite>fcn</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.to_month_end">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">to_month_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.to_month_end" title="Permalink to this definition"></a></dt>
<dd><p>Shift dates to the last dates of the same month.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>date</strong> – datetime Series.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>datetime Series shifted to month end.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.trim">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.trim" title="Permalink to this definition"></a></dt>
<dd><p>Trim <cite>array</cite> within each date that are outside of the quantile values defined by <cite>limits</cite>.</p>
<p>E.g., if <cite>limits</cite> = (0.1, 0.1), trim data below 0.1 quantile and above 0.9 quantile. The elements of <cite>limits</cite> can be
set to None for one-sided trim, e.g., <cite>limits</cite> = (0.1, None).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>Series</em>) – Data to trim. The first index should be date.</p></li>
<li><p><strong>limits</strong> – Pair of quantiles, eg, (0.1, 0.1), (0.1, None).</p></li>
<li><p><strong>by_array</strong> (<em>Series</em>) – Data based on which cut points are determined. If None, <cite>by_array</cite> = <cite>array</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trimmed data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.trim_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">trim_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.trim_data" title="Permalink to this definition"></a></dt>
<dd><p>Trim each column of <cite>data</cite> within each date that are outside of the quantile values defined by <cite>limits</cite>.</p>
<blockquote>
<div><p>The trimmed values are set to nan and the output shape is equal to the input shape.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em>) – Data to trim. The first index should be date.</p></li>
<li><p><strong>limits</strong> – Pair of quantiles, eg, (0.1, 0.1), (0.1, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trimmed data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.winsorize">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">winsorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.winsorize" title="Permalink to this definition"></a></dt>
<dd><p>Winsorize <cite>array</cite> within each date that are outside of the quantile values defined by <cite>limits</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>Series</em>) – Data to winsorize. The first index should be date.</p></li>
<li><p><strong>limits</strong> – Pair of quantiles, eg, (0.1, 0.1), (0.1, None).</p></li>
<li><p><strong>by_array</strong> (<em>Series</em>) – Data based on which cut points are determined. If None, <cite>by_array</cite> = <cite>array</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Winsorized data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.datatools.winsorize_data">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.datatools.</span></span><span class="sig-name descname"><span class="pre">winsorize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.datatools.winsorize_data" title="Permalink to this definition"></a></dt>
<dd><p>Winsorize each column of <cite>data</cite> within each date that are outside of the quantile values defined by <cite>limits</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em>) – Data to winsorize.. The first index should be date.</p></li>
<li><p><strong>limits</strong> – Pair of quantiles, eg, (0.1, 0.1), (0.1, None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Winsorized data.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.ff">
<span id="pyanomaly-ff"></span><h2>pyanomaly.ff<a class="headerlink" href="#module-pyanomaly.ff" title="Permalink to this headline"></a></h2>
<p>Fama-French Factors.</p>
<p>This module defines a function to generate Fama-French factors.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.ff.make_ff_factors">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.ff.</span></span><span class="sig-name descname"><span class="pre">make_ff_factors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.ff.make_ff_factors" title="Permalink to this definition"></a></dt>
<dd><p>Generate Fama-French 3 factors.</p>
<p>This function refers to the WRDS code, but the results are slightly different as the code is written under
the architecture of PyAnomaly. Compared to the data from the K. French website, HML has a correlation of 0.967,
and SMB has a correlation of 0.989. Compared to the WRDS code, HML has a correlation of 0.991,
and SMB has a correlation of 0.993.</p>
<p>WRDS code:
<a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/">https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/</a></p>
<p>Major differences from WRDS code:</p>
<ol class="arabic simple">
<li><p>Primary stock identification: for our method, refer to <code class="docutils literal notranslate"><span class="pre">wrds.add_gvkey_to_crsp()</span></code>.</p></li>
<li><p>Delist return: for our method, refer to <code class="docutils literal notranslate"><span class="pre">wrds.merge_sf_with_seall()</span></code>.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>factors, number of firms.</p>
<ul class="simple">
<li><p>factors (DataFrame): index = ‘date’, columns: ‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’.</p></li>
<li><p>number of firms (DataFrame): index = ‘date’, columns: ‘bh’, ‘bm’, ‘bl’, ‘sh’, ‘sm’, ‘sl’, ‘hml’, ‘smb’.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.ff.make_ff_factors_wrds">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.ff.</span></span><span class="sig-name descname"><span class="pre">make_ff_factors_wrds</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.ff.make_ff_factors_wrds" title="Permalink to this definition"></a></dt>
<dd><p>This is a simple copy of the WRDS code.</p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/">https://wrds-www.wharton.upenn.edu/pages/support/applications/python-replications/fama-french-factors-python/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>factors, number of firms.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.fileio">
<span id="pyanomaly-fileio"></span><h2>pyanomaly.fileio<a class="headerlink" href="#module-pyanomaly.fileio" title="Permalink to this headline"></a></h2>
<p>This module defines functions for file IO.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.fileio.read_from_file">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.fileio.</span></span><span class="sig-name descname"><span class="pre">read_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.fileio.read_from_file" title="Permalink to this definition"></a></dt>
<dd><p>Read data from a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension.</p></li>
<li><p><strong>fdir</strong> – Directory. If None, <cite>config.output_dir</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame read from <cite>fdir/fname.pickle</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.fileio.write_to_file">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.fileio.</span></span><span class="sig-name descname"><span class="pre">write_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.fileio.write_to_file" title="Permalink to this definition"></a></dt>
<dd><p>Write <cite>data</cite> to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dataframe</em>) – Data to save.</p></li>
<li><p><strong>fname</strong> – File name without extension.</p></li>
<li><p><strong>fdir</strong> – Directory. If None, <cite>config.output_dir</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="pyanomaly-jkp">
<span id="id3"></span><h2>pyanomaly.jkp<a class="headerlink" href="#pyanomaly-jkp" title="Permalink to this headline"></a></h2>
<span class="target" id="module-pyanomaly.jkp"></span><p>This module defines functions to generate firm characteristics, factors, and characteristic portfolios
replicating JKP’s SAS code.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.jkp.generate_firm_characterisitcs">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.jkp.</span></span><span class="sig-name descname"><span class="pre">generate_firm_characterisitcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.jkp.generate_firm_characterisitcs" title="Permalink to this definition"></a></dt>
<dd><p>Firm characteristics generation (Replication of JKP’s SAS code).</p>
<p>This function generate the firm characteristics that appear in JKP (2021).
We replicate JKP’s SAS code as closely as possible.
The output is saved to ‘config.output_dir/fname.pickle`.</p>
<p>It is assumed that</p>
<blockquote>
<div><ul class="simple">
<li><p>the raw data has been downloaded from WRDS. If not, call <code class="docutils literal notranslate"><span class="pre">WRDS.download_all()</span></code>;</p></li>
<li><p>factor portfolios has been created. If not, call <code class="docutils literal notranslate"><span class="pre">make_factor_portfolios()</span></code>.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> – Output file name. If None, fname = ‘merge’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.jkp.make_char_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.jkp.</span></span><span class="sig-name descname"><span class="pre">make_char_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighting</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.jkp.make_char_portfolios" title="Permalink to this definition"></a></dt>
<dd><p>Make characteristic portfolios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame of firm characteristics.</p></li>
<li><p><strong>char_list</strong> – List of characteristics to generate.</p></li>
<li><p><strong>weighting</strong> – ‘ew’ (Equal-weight), ‘vw’ (Value-weight), or ‘vw_cap’ (Value-weight capped at 0.8 NYSE-size quantile).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Characteristic portfolio DataFrame with index = date/class and columns = [char, ‘ret’, ‘signal’, ‘n_firms’].
The class values are one of ‘h’, ‘m’, ‘l’, ‘hml’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.jkp.make_factor_portfolio">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.jkp.</span></span><span class="sig-name descname"><span class="pre">make_factor_portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">char</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.jkp.make_factor_portfolio" title="Permalink to this definition"></a></dt>
<dd><p>Make a factor portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataframe with index = date/id. Its columns should include <cite>char</cite>, <cite>ret_col</cite>, <cite>size_class</cite>, and
<cite>weight_col</cite> (optional).</p></li>
<li><p><strong>char</strong> – Characteristic column to make a factor portfolio from.</p></li>
<li><p><strong>ret_col</strong> – Return column.</p></li>
<li><p><strong>size_class</strong> – Size class column.</p></li>
<li><p><strong>weight_col</strong> – Weight column. If None, stocks are equally weighted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of (size x <cite>char</cite>) factor portfolios. Index = ‘date’,
columns: [‘bh’, ‘bl’, ‘bm’, ‘sh’, ‘sl’, ‘sm’, ‘hml’, ‘smb’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.jkp.make_factor_portfolios">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.jkp.</span></span><span class="sig-name descname"><span class="pre">make_factor_portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.jkp.make_factor_portfolios" title="Permalink to this definition"></a></dt>
<dd><p>Make factor portfolios.</p>
<p>FF 3 and HXZ 4 factors are generated. The result is saved to <cite>config.factors_monthly(daily)_fname</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monthly</strong> – If True (False), generate data monthly (daily).</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Factor portfolio dataframe with index = ‘date’ and columns = [‘mktrf’, ‘rf’, ‘smb_ff’, ‘hml’, ‘inv’, ‘roe’,
‘smb_hxz’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.jkp.prepare_data_for_factors">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.jkp.</span></span><span class="sig-name descname"><span class="pre">prepare_data_for_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.jkp.prepare_data_for_factors" title="Permalink to this definition"></a></dt>
<dd><p>Create characteristics needed to make factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>monthly</strong> – If True (False), generate data monthly (daily).</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.panel">
<span id="pyanomaly-panel"></span><h2>pyanomaly.panel<a class="headerlink" href="#module-pyanomaly.panel" title="Permalink to this headline"></a></h2>
<p>This module defines <cite>Panel</cite> class, which serves as the base class for panel data analysis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.panel.</span></span><span class="sig-name descname"><span class="pre">Panel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel" title="Permalink to this definition"></a></dt>
<dd><p>Base class for panel data.</p>
<p>Data is stored in the attribute <cite>data</cite>. <cite>data</cite> should have index = date/id, i.e., the first index should be
time-series identifier and the second index should be cross-section identifier, and always be sorted on id/date.
The date index must be of datetime type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alias</strong> – Characteristic column name in <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>. If None, function names (without ‘c_’) are used as the
characteristic names.</p></li>
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date.</p></li>
<li><p><strong>freq</strong> – Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p></li>
<li><p><strong>base_freq</strong> – Frequency of <cite>data</cite> values. funda: ANNUAL, fundq: QUARTERLY, crspm: MONTHLY, crspd: DAILY.
For example, if funda is populated monthly, <cite>freq</cite> = MONTHLY and <cite>base_freq</cite> = ANNUAL.
If None, <cite>base_freq</cite> = <cite>freq</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.data" title="Permalink to this definition"></a></dt>
<dd><p>DataFrame with index = date/id, sorted on id/date that stores a panel data.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.freq">
<span class="sig-name descname"><span class="pre">freq</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.freq" title="Permalink to this definition"></a></dt>
<dd><p>Frequency of <cite>data</cite>. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.base_freq">
<span class="sig-name descname"><span class="pre">base_freq</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.base_freq" title="Permalink to this definition"></a></dt>
<dd><p>Frequency of <cite>data</cite> values. ANNUAL, QUARTERLY, MONTHLY, or DAILY.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.char_map">
<span class="sig-name descname"><span class="pre">char_map</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.char_map" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary to map functions with aliases. <cite>char_map[‘alias’]</cite> returns its corresponding function name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.reverse_map">
<span class="sig-name descname"><span class="pre">reverse_map</span></span><a class="headerlink" href="#pyanomaly.panel.Panel.reverse_map" title="Permalink to this definition"></a></dt>
<dd><p>Function to alias mapping. <cite>reverse_map[‘function’]</cite> returns its corresponding alias.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.add_row_count">
<span class="sig-name descname"><span class="pre">add_row_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.add_row_count" title="Permalink to this definition"></a></dt>
<dd><p>Add row count column (‘rcount`) to <cite>data</cite>.</p>
<p>The rcount has values 0, 1, … for each ID starting from the first date.
This can be use to remove the first n rows of each ID.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the rows of <cite>data</cite> is changed, e.g., by filtering, this function should be called again as
rcount may no longer be continuous.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.copy" title="Permalink to this definition"></a></dt>
<dd><p>Make a copy of this object and return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – Columns of <cite>data</cite> to copy.</p></li>
<li><p><strong>deep</strong> – If True, copy <cite>data</cite>, otherwise, only the address of <cite>data</cite> is copied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Copy of this object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.copy_from">
<span class="sig-name descname"><span class="pre">copy_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">panel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.copy_from" title="Permalink to this definition"></a></dt>
<dd><p>Copy <cite>panel</cite> to this object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>panel</strong> – <cite>Panel</cite> object to be copied.</p></li>
<li><p><strong>columns</strong> – Columns of <cite>panel.data</cite> to copy.</p></li>
<li><p><strong>deep</strong> – If True, copy <cite>panel.data</cite>, otherwise, only the address of <cite>panel.data</cite> is copied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.create_chars">
<span class="sig-name descname"><span class="pre">create_chars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.create_chars" title="Permalink to this definition"></a></dt>
<dd><p>Generate firm characteristics.</p>
<p>Created firm characteristics are added to <code class="docutils literal notranslate"><span class="pre">data</span></code> using their function names as the column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>char_list</strong> – List of characteristics (aliases) to create. If None, all available characteristics are created.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.cumret">
<span class="sig-name descname"><span class="pre">cumret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.cumret" title="Permalink to this definition"></a></dt>
<dd><p>Compute cumulative returns between t-<cite>period</cite> and t-<cite>lag</cite>.</p>
<p>E.g., 12-month momentum can be obtained by setting <cite>period</cite> = 12 and <cite>lag</cite> = 1.
A negative <cite>period</cite> will generate future returns: eg, <cite>period</cite> = -1 and <cite>lag</cite> = 0 for one-period ahead
return; <cite>period</cite> = -3 and <cite>lag</cite> = -1 for two-period ahead
return starting from t+1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns <cite>ret</cite> should be in <cite>base_freq</cite>. If <cite>base_freq</cite> = ANNUAL, the returns in <cite>ret</cite> should be annual
returns regardless of the value of <cite>freq</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ret</strong> – Series of returns in <cite>base_freq</cite>.</p></li>
<li><p><strong>period</strong> – Target horizon. (+) for past returns and (-) for future returns.</p></li>
<li><p><strong>lag</strong> – Period to calculate returns from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series of cumulative returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.date_col">
<span class="sig-name descname"><span class="pre">date_col</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.date_col" title="Permalink to this definition"></a></dt>
<dd><p>Get date index name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.date_values">
<span class="sig-name descname"><span class="pre">date_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.date_values" title="Permalink to this definition"></a></dt>
<dd><p>Get date index values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.diff" title="Permalink to this definition"></a></dt>
<dd><p>Get the difference of the elements of <cite>data</cite> accounting for frequency.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">data.diff()</span></code> but the actual period between two data points is determined by <cite>freq</cite> and <cite>base_freq</cite>.
See <code class="docutils literal notranslate"><span class="pre">Panel.shift()</span></code> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series or Dataframe.</p></li>
<li><p><strong>n</strong> – Shift size in terms of base frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Differenced data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_row</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.filter" title="Permalink to this definition"></a></dt>
<dd><p>Filter data using the conditions defined by <cite>filters</cite>.</p>
<p>A filter is a tuple of three elements:</p>
<blockquote>
<div><ul class="simple">
<li><p>filter[0]: column to apply the filter to.</p></li>
<li><p>filter[1]: filter condition: ‘==’, ‘!=’, ‘&gt;’, ‘&lt;’, ‘&gt;=’, ‘&lt;=’, ‘in’, or ‘not in’.</p></li>
<li><p>filter[2]: rhs value.</p></li>
</ul>
</div></blockquote>
<p>If <cite>filters</cite> is a list of filters, they are applied sequentially.</p>
<p>For example, to remove <cite>data[‘x’] &lt; 10</cite>,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panel</span><span class="o">.</span><span class="n">filter_data</span><span class="p">((</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>This is equivalent to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">panel</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">panel</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">panel</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> – A filter or list of filters.</p></li>
<li><p><strong>keep_row</strong> – Whether to keep or remove the filtered out rows. If True, the values of the filtered rows are
set to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.futret">
<span class="sig-name descname"><span class="pre">futret</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.futret" title="Permalink to this definition"></a></dt>
<dd><p>Get <cite>period</cite>-period ahead return.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.get_available_chars">
<span class="sig-name descname"><span class="pre">get_available_chars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.get_available_chars" title="Permalink to this definition"></a></dt>
<dd><p>Get the list of available characteristics.</p>
<p>This function returns the aliases of the characteristics defined in <cite>alias</cite> column of <code class="docutils literal notranslate"><span class="pre">mapping.xlsx</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of characteristics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.id_col">
<span class="sig-name descname"><span class="pre">id_col</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.id_col" title="Permalink to this definition"></a></dt>
<dd><p>Get ID index name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.id_values">
<span class="sig-name descname"><span class="pre">id_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.id_values" title="Permalink to this definition"></a></dt>
<dd><p>Get ID index values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.inspect_data">
<span class="sig-name descname"><span class="pre">inspect_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['summary']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.inspect_data" title="Permalink to this definition"></a></dt>
<dd><p>Inspect data.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">datatools.inspect_data()</span></code> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.load" title="Permalink to this definition"></a></dt>
<dd><p>Load this object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = class name.</p></li>
<li><p><strong>fdir</strong> – Directory to read the file from. If None, <cite>fdir</cite> = <cite>config.output_dir</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'right'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.merge" title="Permalink to this definition"></a></dt>
<dd><p>Merge <cite>data</cite> with <cite>right</cite>.</p>
<p>Unlike <cite>pd.merge()</cite>, the index of <cite>data</cite> is always retained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>right</strong> – Series or Dataframe to merge with</p></li>
<li><p><strong>on</strong> – Columns to merge on. If None, merge on index.</p></li>
<li><p><strong>how</strong> – Merge method: ‘inner’, ‘outer’, ‘left’, or ‘right’.</p></li>
<li><p><strong>drop_duplicates</strong> – how to handle duplicate columns. ‘left’: keep right, ‘right’: keep left,
None: keep both. If None, ‘_x’ (‘_y’) are added to the duplicate column names of left (right).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.pct_change">
<span class="sig-name descname"><span class="pre">pct_change</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_negative_denom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.pct_change" title="Permalink to this definition"></a></dt>
<dd><p>Get the percentage change of <cite>data</cite> accounting for frequency.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">data.pct_change()</span></code> but the actual period between two data points is determined by <cite>freq</cite> and <cite>base_freq</cite>.
See <code class="docutils literal notranslate"><span class="pre">Panel.shift()</span></code> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series or Dataframe.</p></li>
<li><p><strong>n</strong> – Shift size in terms of base frequency.</p></li>
<li><p><strong>allow_negative_denom</strong> – If False, set the output to nan when the denominator is not positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series or Dataframe of percentage changes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.populate">
<span class="sig-name descname"><span class="pre">populate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ffill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.populate" title="Permalink to this definition"></a></dt>
<dd><p>Populate data.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">datatools.populate()</span></code> for details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.prepare">
<span class="sig-name descname"><span class="pre">prepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">char_fcns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.prepare" title="Permalink to this definition"></a></dt>
<dd><p>Prepare “ingredient” characteristics that are required to generate a characteristic.</p>
<p>If a characteristic is defined as a function of other characteristics, this function will check whether they
already exist and generate them if they do not exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>char_fcns</strong> – list of function names (without ‘c_’) of the ingredient characteristics.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.remove_rows">
<span class="sig-name descname"><span class="pre">remove_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.remove_rows" title="Permalink to this definition"></a></dt>
<dd><p>Remove (set to nan) the first <cite>nrow</cite> rows of <cite>data</cite> for each ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Dataframe, Series, or ndarray. Its length should be the same as the length of <cite>self.data</cite>.</p></li>
<li><p><strong>nrow</strong> – Number of rows to remove (set to nan).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>data</cite> with rows removed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rename">
<span class="sig-name descname"><span class="pre">rename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rename" title="Permalink to this definition"></a></dt>
<dd><p>Rename <cite>data</cite> columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>to_alias</strong> – If True, rename firm characteristic columns from function names to aliases, and vice-versa.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rolling">
<span class="sig-name descname"><span class="pre">rolling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rolling" title="Permalink to this definition"></a></dt>
<dd><p>Apply <cite>function</cite> to  a rolling window of <cite>data</cite>.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">data.rolling()</span></code> but the actual rolling window is determined by <cite>freq</cite> and <cite>base_freq</cite>.
See <code class="docutils literal notranslate"><span class="pre">Panel.shift()</span></code> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series or Dataframe.</p></li>
<li><p><strong>n</strong> – Window size.</p></li>
<li><p><strong>function</strong> – Function to apply: ‘mean’, ‘std’, ‘var’, ‘sum’, ‘min’, or ‘max’.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations in the window. If observations &lt; <cite>min_n</cite>, result is nan.
If <cite>min_n</cite> = None, <cite>min_n</cite> = <cite>n</cite>.</p></li>
<li><p><strong>lag</strong> – Lag size before start rolling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(Series or Dataframe) Rolling calculation result.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Suppose <cite>funda</cite> is a <cite>Panel</cite> object with <cite>freq</cite> = MONTHLY and <cite>base_freq</cite> = ANNUAL (annual data populated
monthly), and <cite>funda.data</cite> has a return column, ‘ret’. The past three-year average return starting
from one year ago can be calculated (with a condition of at least two non-missing values within the sample
window) and saved as ‘avg_ret3y’ as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">funda</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;avg_ret3y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">funda</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">funda</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ret&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rolling_beta">
<span class="sig-name descname"><span class="pre">rolling_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rolling_beta" title="Permalink to this definition"></a></dt>
<dd><p>Rolling OLS accounting for frequency.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">Panel.rolling_regression()</span></code>: this function is faster but the output is limited to
coefficients, R2, and idiosyncratic volatility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame with index = date/id, sorted on id/date. The first column must be y and the rest X
(not including constant).</p></li>
<li><p><strong>n</strong> – Window size in terms of base frequency.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations in the window. If observations &lt; <cite>min_n</cite>, result is nan.
If <cite>min_n</cite> = None, <cite>min_n</cite> = <cite>n</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coefficients, R2, idiosyncratic volatility. These are NxK, Nx1, and Nx1 ndarrays, respectively,
where N = <cite>len(data)</cite> and K = number of X + 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.rolling_regression">
<span class="sig-name descname"><span class="pre">rolling_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.rolling_regression" title="Permalink to this definition"></a></dt>
<dd><p>Rolling OLS accounting for frequency.</p>
<p>This function internally uses <code class="docutils literal notranslate"><span class="pre">statsmodels.RollingOLS()</span></code>, which is slow when <cite>output</cite> is not None.
Use <code class="docutils literal notranslate"><span class="pre">Panel.rolling_beta()</span></code> if possible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When this function is used, the first <cite>n-1</cite> rows of each ID should be removed. This means that when
<cite>min_n</cite> &lt; <cite>n</cite>, some results can be lost. E.g., if <cite>n</cite> = 5 and <cite>min_n</cite> = 3, the rows with <cite>data.rcount</cite> &lt; 4
should be removed, and the results for <cite>data.rcount</cite> = 3, 4 will be lost.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> – Series of y with index = date/id.</p></li>
<li><p><strong>X</strong> – Series or Dataframe of X with index = date/id.</p></li>
<li><p><strong>n</strong> – Window size in terms of base frequency.</p></li>
<li><p><strong>min_n</strong> – Minimum number of observations in the window. If observations &lt; <cite>min_n</cite>, result is nan.
If <cite>min_n</cite> = None, <cite>min_n</cite> = <cite>n</cite>.</p></li>
<li><p><strong>add_constant</strong> – If True, add constant to <cite>X</cite>.</p></li>
<li><p><strong>output</strong> – List of outputs supported by <code class="docutils literal notranslate"><span class="pre">statsmodels.RollingOLS()</span></code>. If None, estimate coefficients only.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of the coefficients if <cite>output</cite> = None, otherwise, DataFrames of the outputs defined by <cite>output</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.save" title="Permalink to this definition"></a></dt>
<dd><p>Save this object.</p>
<p>Parameters are saved to a json file and <cite>data</cite> is saved to a pickle file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> – File name without extension. If None, <cite>fname</cite> = class name.</p></li>
<li><p><strong>fdir</strong> – Directory to save the file. If None, <cite>fdir</cite> = <cite>config.output_dir</cite>.</p></li>
<li><p><strong>other_columns</strong> – List of columns to save other than firm characteristics. If given, characteristic columns
plus <cite>other_columns</cite> are saved. If None, all columns are saved. Note that unsaved columns will be deleted
from <cite>self.data</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.shift">
<span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.shift" title="Permalink to this definition"></a></dt>
<dd><p>Shift <cite>data</cite> accounting for frequency.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">data.shift()</span></code> but the actual shift period is determined by <cite>freq</cite> and <cite>base_freq</cite>.
E.g., if <cite>freq</cite> = MONTHLY, <cite>base_freq</cite> = ANNUAL, <cite>n</cite> = 1 means 1-year shift, and <cite>data</cite>
is shifted by 12 (12 months). That is, if <cite>base_freq</cite> = ANNUAL (QUARTERLY), <code class="docutils literal notranslate"><span class="pre">shift(n)</span></code> will always shift data
by <cite>n</cite> years (quarters) regardless of the data frequency, <cite>freq</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Series or Dataframe.</p></li>
<li><p><strong>n</strong> – Shift size in terms of base frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shifted data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.show_available_functions">
<span class="sig-name descname"><span class="pre">show_available_functions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.show_available_functions" title="Permalink to this definition"></a></dt>
<dd><p>Display all functions for firm characteristics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.panel.Panel.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.panel.Panel.sum" title="Permalink to this definition"></a></dt>
<dd><p>Sum of <cite>args</cite>.</p>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">sum()</span></code> of SAS: nan’s of <cite>args</cite> are replaced by 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>args</strong> – List of Series.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(Series) Sum of <cite>args</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyanomaly.portfolio">
<span id="pyanomaly-portfolio"></span><h2>pyanomaly.portfolio<a class="headerlink" href="#module-pyanomaly.portfolio" title="Permalink to this headline"></a></h2>
<p>This module defines <code class="docutils literal notranslate"><span class="pre">Portfolo</span></code> and <code class="docutils literal notranslate"><span class="pre">Portfolios</span></code> classes that are used for portfolio analysis.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.portfolio.</span></span><span class="sig-name descname"><span class="pre">Portfolio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfval0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">costfcn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio" title="Permalink to this definition"></a></dt>
<dd><p>Portfolio class.</p>
<p>This class makes a portfolio from positions and evaluate it.</p>
<p>Position information is saved in <cite>position</cite> attribute and portfolio information is saved in <cite>value</cite> attribute.
If positive weights of the positions on a date don’t add up to 1, (1 - sum(positive weights)) will be assumed to be
invested in a risk free asset, and its information is saved in <cite>fposition</cite> attribute.
The transaction cost is assumed to be 0 for risk-free assets.
Once the portfolio is evaluated by calling <code class="docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code>, <cite>performance</cite> attribute is generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Portfolio name.</p></li>
<li><p><strong>position</strong> – Position DataFrame. It should have index = ‘date’ and columns = ‘id’ (security ID) ‘ret’ (return),
and ‘wgt’ (portfolio weight). If it has other columns such as price, they will be kept in the <cite>position</cite>
attribute. If it has ‘rf’ (risk-free rate) column, its values are used as risk-free rates.</p></li>
<li><p><strong>rf</strong> – Risk-free rate DataFrame with index = ‘date’ and columns = ‘rf’. The <cite>rf</cite> has priority over ‘rf’ column in
<cite>position</cite>. If <cite>rf</cite> = None and <cite>position</cite> does not have ‘rf’ column, the risk-free is assumed to be 0.</p></li>
<li><p><strong>pfval0</strong> – Initial portfolio value. Default to 1.</p></li>
<li><p><strong>costfcn</strong> – <cite>TransactionCost</cite> class, a transaction cost function, or value. If a const transaction cost of 20
basis points is assumed, this can be set to 0.002.</p></li>
<li><p><strong>keep_position</strong> – If False, position information (<cite>position</cite>) is deleted after the portfolio is created.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.name" title="Permalink to this definition"></a></dt>
<dd><p>Portfolio name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.position">
<span class="sig-name descname"><span class="pre">position</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.position" title="Permalink to this definition"></a></dt>
<dd><p>Position DataFrame. Its index is ‘date’ and has the following columns:</p>
<ul class="simple">
<li><p>‘id’: security ID provided by the user.</p></li>
<li><p>‘ret’: Return between t-1 and t.</p></li>
<li><p>‘exret’: Excess return over risk-free rate between t-1 and t.</p></li>
<li><p>‘wgt`: Weight at the beginning of t.</p></li>
<li><p>‘val1’: Value at t.</p></li>
<li><p>‘val’: Value at the beginning of t.</p></li>
<li><p>‘val0’: value at t-1.</p></li>
<li><p>‘cost’: Transaction cost incurred at the beginning of t.</p></li>
<li><p>Other columns: Any columns that are in the input position data.</p></li>
</ul>
<p>In the description above, ‘at the beginning of t` means at t-1 after rebalancing.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.value" title="Permalink to this definition"></a></dt>
<dd><p>Portfolio value DataFrame. Its index is ‘date’ and has the following columns:</p>
<ul class="simple">
<li><p>‘ret’: Return between t-1 and t. This can be either net return or gross return depending on
the evaluation method: see <code class="docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code>.</p></li>
<li><p>‘exret’: Excess return over risk-free rate between t-1 and t. This can be either net excess return or
gross excess return depending on the evaluation method.</p></li>
<li><p>‘val1’: Value at t.</p></li>
<li><p>‘val’: Value at the beginning of t.</p></li>
<li><p>‘cost’: Transaction cost incurred at the beginning of t.</p></li>
<li><p>‘tover’: Turnover incurred at the beginning of t. <cite>tover</cite> = sum(pos.val - pos.val0) / sum(pf.val),
where pos.val is the position values and pf.val is the portfolio value.</p></li>
<li><p>‘netret’: Return between t-1 and t, net of transaction cost.</p></li>
<li><p>‘grossret’: Gross return between t-1 and t.</p></li>
<li><p>‘netexret’: Excess return between t-1 and t, net of transaction cost.</p></li>
<li><p>‘grossexret’: Excess gross return between t-1 and t.</p></li>
<li><p>‘lposition’: Number of long positions.</p></li>
<li><p>‘sposition’: Number of short positions.</p></li>
</ul>
<p>Columns added once the portfolio is evaluated by calling <code class="docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code>:</p>
<ul class="simple">
<li><p>‘cumret’: Cumulative return since the first date.</p></li>
<li><p>‘drawdown’: Drawdown.</p></li>
<li><p>‘drawdur’: Duration of daawdown in the frequency of data, e.g., if rebalanced monthly, 3 means 3 months.</p></li>
<li><p>‘drawstart’: Beginning date of drawdown.</p></li>
<li><p>‘succdown’: Successive down; down without any up during the period.</p></li>
<li><p>‘succdur’: Duration of successive down.</p></li>
<li><p>‘succstart’ Beginning date of successive down.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.fposition">
<span class="sig-name descname"><span class="pre">fposition</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.fposition" title="Permalink to this definition"></a></dt>
<dd><p>Risk-free asset position DataFrame. Its index is ‘date’ and has the following columns:</p>
<ul class="simple">
<li><p>‘ret’: Return between t-1 and t.</p></li>
<li><p>‘wgt`: Weight at the beginning of t.</p></li>
<li><p>‘val1’: Value at t.</p></li>
<li><p>‘val’: Value at the beginning of t.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.performance">
<span class="sig-name descname"><span class="pre">performance</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.performance" title="Permalink to this definition"></a></dt>
<dd><p>Portfolio performance DataFrame. Its column is equal to the portfolio name and has the following
indexes:</p>
<ul class="simple">
<li><p>‘mean’: Mean excess return over the evaluation period.</p></li>
<li><p>‘std’: Standard deviation of the excess returns over the evaluation period.</p></li>
<li><p>‘sharpe’: Sharpe ratio.</p></li>
<li><p>‘cum’: : Cumulative return over the evaluation period.</p></li>
<li><p>‘mdd’: Maximum drawdown.</p></li>
<li><p>‘mdd start’: Maximum drawdown start date.</p></li>
<li><p>‘mdd end’: Maximum drawdown end date.</p></li>
<li><p>‘msd’: Maximum successive down.</p></li>
<li><p>‘msd start’: Maximum successive down start date.</p></li>
<li><p>‘msd end’: Maximum successive down end date.</p></li>
<li><p>‘turnover’: Average turnover.</p></li>
<li><p>‘lposotion’: Average number of long positions.</p></li>
<li><p>‘sposition’: Average number of short positions.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.costfcn">
<span class="sig-name descname"><span class="pre">costfcn</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.costfcn" title="Permalink to this definition"></a></dt>
<dd><p><cite>TransactionCost</cite> object, a transaction cost function, or value. For example, if a const transaction
cost of 20 basis points is assumed, <cite>costfcn</cite> can be simply set to 0.002.</p>
<p>If <cite>costfcn</cite> is a <cite>TransactionCost</cite> object, <code class="docutils literal notranslate"><span class="pre">TransactionCost.get_cost(position)</span></code> is called to get
transaction costs. <cite>TransactionCost</cite> allows transaction costs varying across time and securities.
See <code class="docutils literal notranslate"><span class="pre">pyanomaly.tcost</span></code> module for more details.</p>
<p>When <cite>costfcn</cite> is defined as a function, the transaction cost function should have arguments
val (value after rebalancing) and val0 (value before rebalancing). For example, if the transaction cost
to buy (sell) is 20 (30) bps, a function can be defined as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cost_fcn</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">val0</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.002</span> <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">val0</span> <span class="k">else</span> <span class="mf">0.003</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a position exists at t-1 but not at t, it will be added at t with 0 weight.
This is to compute the transaction cost.</p>
<p>‘val’, ‘val1’, and ‘val0’ in <cite>position</cite> and <cite>value</cite> are calculated without taking transaction costs into account.
For the value increase after transaction costs, use the cumulative return.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.add_position">
<span class="sig-name descname"><span class="pre">add_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.add_position" title="Permalink to this definition"></a></dt>
<dd><p>Add new positions.</p>
<p>This method assumes positions are added in order of time. All positions of a given date must be added together.
The arguments have the same formats as those of the initializer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy this object for the given period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’).</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Portfolio</cite> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.cum_return">
<span class="sig-name descname"><span class="pre">cum_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.cum_return" title="Permalink to this definition"></a></dt>
<dd><p>Get the cumulative return over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale cumulative return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cumulative return.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.cum_returns">
<span class="sig-name descname"><span class="pre">cum_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.cum_returns" title="Permalink to this definition"></a></dt>
<dd><p>Get portfolio cumulative returns.</p>
<p>Both <cite>sdate</cite> and <cite>edate</cite> are inclusive, i.e., the first return is the return over <cite>sdate</cite>-1 and <cite>sdate</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale cumulative returns.</p></li>
<li><p><strong>zero_start</strong> – If True, the return at <cite>sdate</cite> is forced to 0. That is, it is assumed that trading starts
at the end of <cite>sdate</cite>. This is useful when plotting cumulative returns as all curves will start at the
same point, 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cumulative return Series with index = ‘date’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.drawdown">
<span class="sig-name descname"><span class="pre">drawdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.drawdown" title="Permalink to this definition"></a></dt>
<dd><p>Get the drawdowns over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of drawdowns with index = ‘date’ and columns = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.eval" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the portfolio over the period.</p>
<p>This method evaluate the portfolio and create <cite>performance</cite> attribute. It also adds performance-related columns
to <cite>value</cite> attribute.</p>
<p><cite>performance</cite>: DataFrame with columns = [<cite>name</cite>] and the following indexes:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘mean’: Mean excess return over the evaluation period.</p></li>
<li><p>‘std’: Standard deviation of the excess returns over the evaluation period.</p></li>
<li><p>‘sharpe’: Sharpe ratio.</p></li>
<li><p>‘cum’: : Cumulative return over the evaluation period.</p></li>
<li><p>‘mdd’: Maximum drawdown.</p></li>
<li><p>‘mdd start’: Maximum drawdown start date.</p></li>
<li><p>‘mdd end’: Maximum drawdown end date.</p></li>
<li><p>‘msd’: Maximum successive down.</p></li>
<li><p>‘msd start’: Maximum successive down start date.</p></li>
<li><p>‘msd end’: Maximum successive down end date.</p></li>
<li><p>‘turnover’: Average turnover.</p></li>
<li><p>‘lposotion’: Average number of long positions.</p></li>
<li><p>‘sposition’: Average number of short positions.</p></li>
</ul>
</div></blockquote>
<p>Columns added to <cite>value</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘cumret’: Cumulative return since <cite>sdate</cite>.</p></li>
<li><p>‘drawdown’: Drawdown.</p></li>
<li><p>‘drawdur’: Duration of daawdown in the frequency of data, e.g., if rebalanced monthly, 3 means 3 months.</p></li>
<li><p>‘drawstart’: Beginning date of drawdown.</p></li>
<li><p>‘succdown’: Successive down; down without any up during the period.</p></li>
<li><p>‘succdur’: Duration of successive down.</p></li>
<li><p>‘succstart’ Beginning date of successive down.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, ‘cum’, ‘mdd’, ‘msd’ are in log-scale.</p></li>
<li><p><strong>annualize_factor</strong> – ‘mean’, ‘std’, ‘sharpe’, and ‘turnover’ are annualized by this factor, e.g.,
<cite>mean</cite> is multiplied by <cite>annualize_factor</cite> and <cite>std</cite> by its square-root.
If the data is monthly, the results can be annualized by setting <cite>annualize_factor</cite> = 12. Default to 1.</p></li>
<li><p><strong>consider_cost</strong> – If True, the results are calculated using net returns, otherwise, they are calculated
using gross returns. If True (False), <cite>value.ret</cite> will be set to <cite>value.netret</cite> (<cite>value.grossret</cite>).</p></li>
<li><p><strong>percentage</strong> – If True, ‘mean’, ‘std’, ‘cum’, ‘mdd’, ‘msd’, and ‘turnover’ are multiplied by 100.
Default to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>performance</cite>, <cite>value</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.eval_series">
<span class="sig-name descname"><span class="pre">eval_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.eval_series" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the portfolio repeatedly over the period.</p>
<p>Evaluate the portfolio repeatedly for the period [<cite>sdate</cite>, <cite>sdate+1</cite>], [<cite>sdate</cite>, <cite>sdate+2</cite>], …,
[<cite>sdate</cite>, <cite>edate</cite>]. For the description of the arguments, see <code class="docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Performance for each period. DataFrame with index values equal to the period end dates and columns
equal to the indexes of <cite>performance</cite> attribute, i.e., a row with index t contains the performance up to t.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.from_portfolo_return">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_portfolo_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pfret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.from_portfolo_return" title="Permalink to this definition"></a></dt>
<dd><p>Make a portfolio given portfolio returns.</p>
<p>If portfolio returns are already known, this method can be used to construct a <cite>Portfoliio</cite> object
and evaluate the portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pfret</strong> – DataFrame with index = ‘date’ and columns = ‘ret’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>Portfolio</cite> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.max_drawdown">
<span class="sig-name descname"><span class="pre">max_drawdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.max_drawdown" title="Permalink to this definition"></a></dt>
<dd><p>Get the maximum drawdown over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Maximum drawdown. Series with index = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.max_succdown">
<span class="sig-name descname"><span class="pre">max_succdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.max_succdown" title="Permalink to this definition"></a></dt>
<dd><p>Get the maximum successive down over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Maximum successive down. Series with index = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.mean_return">
<span class="sig-name descname"><span class="pre">mean_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.mean_return" title="Permalink to this definition"></a></dt>
<dd><p>Get portfolio mean return over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mean return.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.returns">
<span class="sig-name descname"><span class="pre">returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.returns" title="Permalink to this definition"></a></dt>
<dd><p>Get portfolio returns.</p>
<p>Both <cite>sdate</cite> and <cite>edate</cite> are inclusive, i.e., the first return is the return over <cite>sdate</cite>-1 and <cite>sdate</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Return Series with index = ‘date’.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.set_position">
<span class="sig-name descname"><span class="pre">set_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfval0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.set_position" title="Permalink to this definition"></a></dt>
<dd><p>Set positions.</p>
<p>This method sets <cite>position</cite> attribute from the input arguments.
For the details of the input arguments, See the arguments of the initializer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.set_return_type">
<span class="sig-name descname"><span class="pre">set_return_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consider_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.set_return_type" title="Permalink to this definition"></a></dt>
<dd><p>Determine which return (gross vs. net) to use for portfolio evaluation.</p>
<p>If <cite>consider_cost</cite> is True, <cite>value.ret</cite> and <cite>value.exret</cite> are respectively set to net returns (<cite>value.netret</cite>)
and net excess returns (<cite>value.netexret</cite>). Otherwise, they are set to gross returns (<cite>value.grossret</cite>) and
gross excess returns (<cite>value.grossexret</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>consider_cost</strong> – True to use returns net of transaction costs for evaluation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.sharpe_ratio">
<span class="sig-name descname"><span class="pre">sharpe_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.sharpe_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Get the Sharpe ratio over the period.</p>
<p>If risk-free rates are not set, they are assumed to be 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sharpe ratio.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.std_return">
<span class="sig-name descname"><span class="pre">std_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.std_return" title="Permalink to this definition"></a></dt>
<dd><p>Get the standard deviation of the returns over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standard deviation of the returns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolio.succdown">
<span class="sig-name descname"><span class="pre">succdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolio.succdown" title="Permalink to this definition"></a></dt>
<dd><p>Get the successive downs over the period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>logscale</strong> – If True, return log-scale values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Successive downs. DataFrame with index = ‘date’ and columns = [‘value’, ‘duration’, ‘start’].</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.portfolio.</span></span><span class="sig-name descname"><span class="pre">Portfolios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolios</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios" title="Permalink to this definition"></a></dt>
<dd><p>Class for a group of portfolios.</p>
<p>This class can have several portfolios as its members and evaluate them together.
This class facilitates portfolio comparison by evaluating them and saving the results in a single DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>portfolios</strong> – List or dict of <cite>Portfolio</cite> objects to add. If it is a dict, its keys are used as
portfolio names. Portfolios can be added later using <code class="docutils literal notranslate"><span class="pre">Portfolios.add()</span></code> or <code class="docutils literal notranslate"><span class="pre">Portfolios.set()</span></code>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.members">
<span class="sig-name descname"><span class="pre">members</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.members" title="Permalink to this definition"></a></dt>
<dd><p>Portfolio members. A <cite>Portfolio</cite> object is added to <cite>members</cite> with its name as the key.
A member portfolio can be accessed by <code class="docutils literal notranslate"><span class="pre">__getitem__()</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">Portfolio</span><span class="p">(</span><span class="s1">&#39;pf1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portfolios</span> <span class="o">=</span> <span class="n">Portfolios</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portfolios</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pf1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">portfolios</span><span class="p">[</span><span class="s1">&#39;pf1&#39;</span><span class="p">]</span>  <span class="c1"># This and the next line are equivalent.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pf1</span> <span class="o">=</span> <span class="n">portfolios</span><span class="o">.</span><span class="n">members</span><span class="p">[</span><span class="s1">&#39;pf1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.value" title="Permalink to this definition"></a></dt>
<dd><p>Portfolios’ values. This is a concatenated DataFrame of the <cite>value</cite> attributes of the members.
It has the same structure as <cite>Portfolio.value</cite> except that its columns are two-level: the first level
is the same as the columns of <cite>Portfolio.value</cite> and the second level is the member names.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.performance">
<span class="sig-name descname"><span class="pre">performance</span></span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.performance" title="Permalink to this definition"></a></dt>
<dd><p>Portfolios’ performances. This is a concatenated DataFrame of the <cite>performance</cite> attributes of
the members. It has the same structure as <cite>Portfolio.performance</cite> except that it has multiple columns,
each corresponding to a member. The column names are the same as the portfolio names.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.add" title="Permalink to this definition"></a></dt>
<dd><p>Add a portfolio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>portfolio</strong> (<a class="reference internal" href="#pyanomaly.portfolio.Portfolio" title="pyanomaly.portfolio.Portfolio"><em>Portfolio</em></a>) – Portfolio to add.</p></li>
<li><p><strong>alias</strong> – Portfolio alias. If not None, this is used as the portfolio name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annualize_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_cost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.eval" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the portfolios.</p>
<p>For the arguments, see <code class="docutils literal notranslate"><span class="pre">Portfolio.eval()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>performance</cite>, <cite>value</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.portfolio.Portfolios.set">
<span class="sig-name descname"><span class="pre">set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">portfolios</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.portfolio.Portfolios.set" title="Permalink to this definition"></a></dt>
<dd><p>Add portfolios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>portfolios</strong> – List or dict of <cite>Portfolio</cite> objects. If it is a dict, its keys are used as
portfolio names.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="pyanomaly-tcost">
<span id="id4"></span><h2>pyanomaly.tcost<a class="headerlink" href="#pyanomaly-tcost" title="Permalink to this headline"></a></h2>
<span class="target" id="module-pyanomaly.tcost"></span><p>This module defines classes for transaction costs.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.tcost.TimeVaryingCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.tcost.</span></span><span class="sig-name descname"><span class="pre">TimeVaryingCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">me</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TimeVaryingCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyanomaly.tcost.TransactionCost" title="pyanomaly.tcost.TransactionCost"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyanomaly.tcost.TransactionCost</span></code></a></p>
<p>Transaction costs that vary over time and across firm sizes.</p>
<p>This class implements the time-varying transaction costs used in, e.g., Brandt et al. (2009), Hand and Green (2011),
DeMiguel et al. (2020), and Han (2021). Transaction cost parameter <cite>k</cite> is defined as <cite>k</cite> = <cite>y</cite> * <cite>z</cite>,
where <cite>y</cite> decreases linearly from 4.0 in 1974.01 to 1.0 in 2002.01 and remains at 1.0 thereafter, and
<cite>z</cite> = 0.006 - 0.0025 * <cite>nme</cite>, where <cite>nme</cite> is the normalized market equity that has a value between 0 and 1.</p>
<p>The maximum transaction cost is 240 basis points (the smallest firm before 1974) and the minimum transaction cost is
35 basis points (the largest firm after 2002).</p>
<p>We find this assumption is too conservative since the normalized me is sensitive to the largest company.
In 1974, the mean of the normalized me is only 0.0045 and most firms have the transaction cost of 240 basis points,
and in 2002, the mean of the normalized me is only 0.0059 and most firms have the transaction cost of 60 basis points.</p>
<p>Using a logarithm of the market equity or capping the me of the largest firms may make more sense.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TimeVaryingCost.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">me</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TimeVaryingCost.set_params" title="Permalink to this definition"></a></dt>
<dd><p>Set transaction cost parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>me</strong> – DataFrame or Series of market equity with index = date/id.</p></li>
<li><p><strong>normalize</strong> – If True, normalize <cite>me</cite> so that its values are between 0 and 1.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the input contains only a subset of all listed stocks, normalizing the market equity can result in
over- or underestimation of the transaction costs. For example, if <cite>me</cite> contains only top 80% of the stocks,
the transaction costs will be overestimated. Use all listed stocks in the market or normalize the market equity
outside and set <cite>normalize = False</cite>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.tcost.</span></span><span class="sig-name descname"><span class="pre">TransactionCost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Transaction cost class.</p>
<p>Trnansaction cost can be set at the security level. It can also vary over time. See <code class="docutils literal notranslate"><span class="pre">set_params()</span></code> for details.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.params" title="Permalink to this definition"></a></dt>
<dd><p>Transaction cost parameters. This can be a float number, dict, or DataFrame. See <code class="docutils literal notranslate"><span class="pre">set_params()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.get_cost">
<span class="sig-name descname"><span class="pre">get_cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.get_cost" title="Permalink to this definition"></a></dt>
<dd><p>Get transaction costs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position</strong> – Portfolio positions. <code class="docutils literal notranslate"><span class="pre">Portfolio</span></code> object calls this function with the argument,
<code class="docutils literal notranslate"><span class="pre">Portfolio.position</span></code>, to get transaction costs. The <cite>position</cite> argument should have index = ‘date’ and
columns = [<cite>id</cite>, ‘val’, ‘val0’], where ‘val’ is the value after rebalancing and ‘val0’ is the value
before rebalancing.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transaction costs. A vector with the same length as <cite>position</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.get_cost_">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_cost_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.get_cost_" title="Permalink to this definition"></a></dt>
<dd><p>Get a quadratic transaction cost</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> – Value after rebalancing.</p></li>
<li><p><strong>val0</strong> – Value before rebalancing.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Transaction cost parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Transaction cost.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.tcost.TransactionCost.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.tcost.TransactionCost.set_params" title="Permalink to this definition"></a></dt>
<dd><p>Set transaction cost parameters.</p>
<p>Parameters can be set either by this method or by <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – <p><cite>kwargs</cite> can have the following keywords:</p>
<ul class="simple">
<li><p>’cost’: For a constant (scalar) transaction cost.</p></li>
<li><p>’buy_fixed`, ‘buy_linear`, ‘buy_quad’, ‘sell_fixed’, ‘sell_linear’, ‘sell_quad’: For
a quadratic transaction cost.</p></li>
<li><p>’params’: For a transaction cost that varies across securities (and over time).</p></li>
</ul>
</p>
</dd>
</dl>
<p>Below are some examples.</p>
<p>For a constant transaction cost of 20 basis points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">cost</span><span class="o">=</span><span class="mf">0.002</span><span class="p">)</span>
</pre></div>
</div>
<p>Asymmetric quadratic cost function:</p>
<blockquote>
<div><p><cite>cost = fixed + linear * Amount + quad * Amount^2</cite></p>
<ul class="simple">
<li><p>To buy: fixed cost = $5, linear cost = 0.002, and quadratic cost = 0.001</p></li>
<li><p>To sell: fixed cost = 0, linear cost = 0.003, and quadratic cost = 0.001</p></li>
</ul>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">buy_fixed</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">buy_linear</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> <span class="n">buy_quad</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">sell_linear</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">sell_quad</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>Only non-zero parameters need to be provided.</p>
</div></blockquote>
<p>Transaction costs that vary across securities:</p>
<blockquote>
<div><ul class="simple">
<li><p>Security 1 (id: 0001): 0.002, security 2 (id: 0002): 0.003</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;cost&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.002</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">]},</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;0001&#39;</span><span class="p">,</span> <span class="s1">&#39;0002&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">      cost</span>
<span class="go">id</span>
<span class="go">0001 0.002</span>
<span class="go">0002 0.003</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>Transaction costs that vary across securities and dates:</p>
<blockquote>
<div><ul class="simple">
<li><p>Security 1 (id: 0001): 0.004 on ‘2000-03-31’, 0.003 on ‘2000-04-30’</p></li>
<li><p>Security 2 (id: 0002): 0.005 on ‘2000-03-31’, 0.004 on ‘2000-04-30’</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2000-03-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2000-04-30&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0001&#39;</span><span class="p">,</span> <span class="s1">&#39;0002&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([</span><span class="n">dates</span><span class="p">,</span> <span class="n">ids</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.003</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">                 cost</span>
<span class="go">date       id</span>
<span class="go">2000-03-31 0001 0.004</span>
<span class="go">           0002 0.005</span>
<span class="go">2000-04-30 0001 0.003</span>
<span class="go">           0002 0.004</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tc</span> <span class="o">=</span> <span class="n">TransactionCost</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>The <cite>params</cite> DataFrame must have index = ‘id’ or ‘date’/’id’. It can have columns such as ‘buy_fixed’ instead
of ‘cost’ for a more complex transaction cost structure.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pyanomaly.util">
<span id="pyanomaly-util"></span><h2>pyanomaly.util<a class="headerlink" href="#module-pyanomaly.util" title="Permalink to this headline"></a></h2>
<p>This module defines utility functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.drop_columns">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">drop_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.drop_columns" title="Permalink to this definition"></a></dt>
<dd><p>Delete <cite>cols</cite> columns from <cite>data</cite>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_iterable">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_iterable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_iterable" title="Permalink to this definition"></a></dt>
<dd><p>Check if <cite>x</cite> is iterable.</p>
<p>A string, a iterable object, is considered not iterable in this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if <cite>x</cite> is iterable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.is_zero">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">is_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.is_zero" title="Permalink to this definition"></a></dt>
<dd><p>Check if <cite>x</cite> is zero.</p>
<p>A value is considered 0 if it is in the range (-1.e-7, 1.e-7).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – A scalar or array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.keep_columns">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">keep_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.keep_columns" title="Permalink to this definition"></a></dt>
<dd><p>Delete columns of <cite>data</cite> except <cite>cols</cite>.</p>
<p>Equivalent to <cite>data = data[cols]</cite>, but much more memory efficient.
Not sure why but the following two methods seem to momentarily consume a lot of memory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">cols</span><span class="p">),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Use this function when handling a large dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – DataFrame.</p></li>
<li><p><strong>cols</strong> – List of columns to keep.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.to_list">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.to_list" title="Permalink to this definition"></a></dt>
<dd><p>Convert <cite>x</cite> to a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – a list, tuple, or scalar.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>x</cite> converted to list.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyanomaly.util.unique_list">
<span class="sig-prename descclassname"><span class="pre">pyanomaly.util.</span></span><span class="sig-name descname"><span class="pre">unique_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.util.unique_list" title="Permalink to this definition"></a></dt>
<dd><p>Get a list of unique elements of <cite>x</cite>.</p>
<p>If <cite>x</cite> contains a list, its elements are considered elements of <cite>x</cite>, not the list itself.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unique_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A list.</p></li>
<li><p><strong>exclude_nan</strong> – If True, exclude None elements.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of unique elements of <cite>x</cite>.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyanomaly.wrdsdata">
<span id="pyanomaly-wrdsdata"></span><h2>pyanomaly.wrdsdata<a class="headerlink" href="#module-pyanomaly.wrdsdata" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyanomaly.wrdsdata.</span></span><span class="sig-name descname"><span class="pre">WRDS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrds_username</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS" title="Permalink to this definition"></a></dt>
<dd><p>Class to download/handle WRDS data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wrds_username</strong> – WRDS username. Necessary only when downloading data: can be set to None when reading
data from files.</p>
</dd>
</dl>
<p><strong>Methods for Data Download</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">download_table()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_table_async()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_funda()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_fundq()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_sf()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_seall()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_secd()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_g_secd()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">download_all()</span></code></p></li>
</ul>
</div></blockquote>
<p><strong>Other Methods</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">create_pgpass_file()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">merge_sf_with_seall()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_gvkey_to_crsp()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_crsp()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">convert_fund_currency_to_usd()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_risk_free_rate()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">add_gvkey_to_crsp()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_data()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">read_data()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">save_as_csv()</span></code></p></li>
</ul>
</div></blockquote>
<p class="rubric">References</p>
<p>CRSP overview: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/data-overview/wrds-overview-crsp-us-stock-database/">https://wrds-www.wharton.upenn.edu/pages/support/data-overview/wrds-overview-crsp-us-stock-database/</a></p>
<p>CRSP-Compustat merge: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/crsp/crspcompustat-merged-ccm/wrds-overview-crspcompustat-merged-ccm/">https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/crsp/crspcompustat-merged-ccm/wrds-overview-crspcompustat-merged-ccm/</a></p>
<p>CRSP annual update tables: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/crsp_a_indexes/">https://wrds-www.wharton.upenn.edu/data-dictionary/crsp_a_indexes/</a></p>
<p>shrcd: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/shrcd/">https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/shrcd/</a></p>
<p>exchcd: <a class="reference external" href="https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/exchcd/">https://wrds-www.wharton.upenn.edu/data-dictionary/form_metadata/crsp_a_stock_msf_identifyinginformation/exchcd/</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.db">
<span class="sig-name descname"><span class="pre">db</span></span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.db" title="Permalink to this definition"></a></dt>
<dd><p>A wrds object to connect to WRDS database.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_gvkey_to_crsp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.add_gvkey_to_crsp" title="Permalink to this definition"></a></dt>
<dd><p>Add gvkey to m(d)sf using ccmxpf_linktable and identify primary stocks.</p>
<p>There are two tables we can use to link permno with gvkey: ccmxpf_linktable and ccmxpf_linkhist.
ccmxpf_lnkused is simply a merge table of ccmxpf_lnkhist and ccmxpf_lnkused.</p>
<p>We identify primary stocks in the following order.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If linkprim = ‘P’ or ‘C’, set the security as primary.</p></li>
<li><p>If permno and gvkey have 1:1 mapping, set the security as primary.</p></li>
<li><p>Among the securities with the same gvkey, set the one with the maximum trading volume as primary.</p></li>
<li><p>Among the securities with the same permco and missing gvkey, set the one with the maximum trading volume
as primary.</p></li>
</ol>
</div></blockquote>
<p class="rubric">References</p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/research-wrds/macros/wrds-macros-cvccmlnksas/">https://wrds-www.wharton.upenn.edu/pages/support/research-wrds/macros/wrds-macros-cvccmlnksas/</a></p>
<p><a class="reference external" href="https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/">https://wrds-www.wharton.upenn.edu/pages/support/applications/linking-databases/linking-crsp-and-compustat/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sf</strong> – m(d)sf Dataframe with index = ‘date’/’permno’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>m(d)sf with ‘gveky’ and ‘primary’ (primary stock indicator) columns added.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_fund_currency_to_usd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fund</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'funda'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.convert_fund_currency_to_usd" title="Permalink to this definition"></a></dt>
<dd><p>Convert non-USD values of funda(q) to USD values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Compustat North America, the accounting data can be in either USD and CAD. This is no problem if firm
characteristics are generated using only Compustat. However, if you mix data from different databases, e.g.,
if you use market equity of CRSP, which is in USD, Compustat data should be converted to USD.</p>
<p>Following JKP, we use compustat.exrt_dly to obtain exchange rates. exrt_dly starts from 1982-02-01.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fund</strong> – funda(q) DataFrame with index = ‘datadate’/’gvkey’.</p></li>
<li><p><strong>table</strong> – ‘funda’ or ‘fundq’: indicator whether <cite>fund</cite> is funda or fundq.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Converted <cite>fund</cite> DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.create_pgpass_file">
<span class="sig-name descname"><span class="pre">create_pgpass_file</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.create_pgpass_file" title="Permalink to this definition"></a></dt>
<dd><p>Create pgpass file. Need to be called only once. Once created, you don’t need to enter password when
connecting to WRDS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_all">
<span class="sig-name descname"><span class="pre">download_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_all" title="Permalink to this definition"></a></dt>
<dd><p>Download all tables.</p>
<p>Currently, this function downloads the following tables:</p>
<ul class="simple">
<li><p>comp.funda</p></li>
<li><p>comp.fundq</p></li>
<li><p>crsp.msf (merged with crsp.msenames)</p></li>
<li><p>crsp.dsf (merged with crsp.dsenames)</p></li>
<li><p>crsp.mseall</p></li>
<li><p>crsp.dseall</p></li>
<li><p>crsp.ccmxpf_linktable</p></li>
<li><p>crsp.mcti</p></li>
<li><p>ff.factors_monthly</p></li>
<li><p>ff.factors_daily</p></li>
<li><p>comp.exrt_dly</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_funda">
<span class="sig-name descname"><span class="pre">download_funda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_funda" title="Permalink to this definition"></a></dt>
<dd><p>Download comp.funda.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_fundq">
<span class="sig-name descname"><span class="pre">download_fundq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_fundq" title="Permalink to this definition"></a></dt>
<dd><p>Download comp.fundq.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_g_secd">
<span class="sig-name descname"><span class="pre">download_g_secd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_g_secd" title="Permalink to this definition"></a></dt>
<dd><p>Download comp.g_secd.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_seall">
<span class="sig-name descname"><span class="pre">download_seall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_seall" title="Permalink to this definition"></a></dt>
<dd><p>Download delist info from m(d)seall.</p>
<p>Delist can be obtained from either mseall or msedelist. We use mseall since it contains exchcd, which is used
when replacing missing dlret.
The shrcd and exchcd in mseall are usually those before halting/suspension. If a stock in NYSE is halted, exchcd
in msenames can be -2, whereas that in mseall is 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>monthly</strong> – If True download mseall else dseall.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_secd">
<span class="sig-name descname"><span class="pre">download_secd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_secd" title="Permalink to this definition"></a></dt>
<dd><p>Download comp.secd.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_sf">
<span class="sig-name descname"><span class="pre">download_sf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_sf" title="Permalink to this definition"></a></dt>
<dd><p>Download crsp.m(d)sf joined with crsp.m(d)senames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date. e.g., ‘2000-01-01’. Set to None to download all data.</p></li>
<li><p><strong>edate</strong> – End date. Set to None to download all data.</p></li>
<li><p><strong>monthly</strong> – If True download msf else dsf.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download concurrently. Faster but memory hungrier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_table">
<span class="sig-name descname"><span class="pre">download_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coerce_float</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_table" title="Permalink to this definition"></a></dt>
<dd><p>Download a table from WRDS library.</p>
<p>This is a wrapping function of <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.
The queried table is saved in config.input_dir/library/table.pickle. Useful when downloading an entire table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>library</strong> – WRDS library. e.g., crsp, comp, …</p></li>
<li><p><strong>table</strong> – A table in <cite>library</cite>.</p></li>
<li><p><strong>obs</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>offset</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>columns</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>coerce_float</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>index_col</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
<li><p><strong>date_cols</strong> – See <code class="docutils literal notranslate"><span class="pre">wrds.get_table()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.download_table_async">
<span class="sig-name descname"><span class="pre">download_table_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">library</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sdate=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval=5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_tables=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=&lt;class</span> <span class="pre">'float'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_cols=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_in_executer=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.download_table_async" title="Permalink to this definition"></a></dt>
<dd><p>Asynchronous download.</p>
<p>This method splits the total period into <cite>interval</cite> years and downloads data for each sub-period
asynchronously. If download fails, it can be started from the failed date: already downloaded files will be
gathered together. This method allow us to download a large table, e.g., crsp.dsf, reliably without connection
timeout and consumes much less memory than <code class="docutils literal notranslate"><span class="pre">WRDS.download_table()</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a small table, this can be slower than <code class="docutils literal notranslate"><span class="pre">WRDS.download_table()</span></code>.
Table should have a date field (<cite>date_col</cite>) to split the period.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>library</strong> – WRDS library.</p></li>
<li><p><strong>table</strong> – WRDS table. If a complete query is given, this can be any name: this is used only as the file name
for the data.</p></li>
<li><p><strong>sql</strong> – String of the fields to select or a complete query statement. See below.</p></li>
<li><p><strong>date_col</strong> – Date field on which downloaing will be split.</p></li>
<li><p><strong>sdate</strong> – Start date (‘yyyy-mm-dd’). If None, ‘1900-01-01’.</p></li>
<li><p><strong>edate</strong> – End date. If None, today.</p></li>
<li><p><strong>interval</strong> – Sub-period size in years.</p></li>
<li><p><strong>src_tables</strong> – List of (library, table) that are used in the query. <cite>src_tables</cite> are used to get data types
and convert the types of double precision fields to float. When data is selected from a single table,
<cite>library.table</cite>, this can be set to None.</p></li>
<li><p><strong>type</strong> – Type for numeric fields: float or np.float32. For a large dataset, converting to float32 can save
disc space and read/write time.</p></li>
<li><p><strong>date_cols</strong> – List of date columns. The dtype of these columns will be converted to datetime.</p></li>
<li><p><strong>run_in_executer</strong> – If True, download data concurrently using <cite>executer</cite>. Setting this to True will increase
download speed but can take up much memory.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>To download library.table, <cite>library</cite>, <cite>table</cite>, and <cite>date_col</cite> should be given.</p></li>
<li><p>To download selected fields from library.table, library, <cite>table</cite>, <cite>sql</cite>, and <cite>date_col</cite> should be given, where
<cite>sql</cite> is a string of the fields to select, e.g.,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span> <span class="o">=</span> <span class="n">WRDS</span><span class="p">(</span><span class="s1">&#39;user_name&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sql</span> <span class="o">=</span> <span class="s1">&#39;permno, prc, exchcd&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrds</span><span class="o">.</span><span class="n">download_table_async</span><span class="p">(</span><span class="s1">&#39;crsp&#39;</span><span class="p">,</span> <span class="s1">&#39;msf&#39;</span><span class="p">,</span> <span class="n">sql</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>To download data using a complete query, <cite>library</cite>, <cite>table</cite>, and <cite>sql</cite> should be given, where <cite>table</cite> is a table
name for the data (can be any name), and <cite>sql</cite> is a query statement. The <cite>sql</cite> should contain
‘WHERE [<cite>date_col</cite>] BETWEEN {} and {}’. See, e.g., the code of <code class="docutils literal notranslate"><span class="pre">WRDS.download_sf()</span></code>.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.get_risk_free_rate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_risk_free_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sdate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mcti'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.get_risk_free_rate" title="Permalink to this definition"></a></dt>
<dd><p>Get risk-free rate.</p>
<p>The risk free rate can be obtained either from crsp.mcti or ff.factors_monthly.
mcti is preferred since the values in factors_monthly have only 4 decimal places.
Both risk-free rates are in decimal (not percentage values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sdate</strong> – Start date.</p></li>
<li><p><strong>edate</strong> – End date.</p></li>
<li><p><strong>src</strong> – data source. ‘mcti’: crsp.mcti, ‘ff’: ff.factors_monthly.</p></li>
<li><p><strong>month_end</strong> – Shift dates to the end of the month.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe of risk-free rates with index = ‘date’ and columns = [‘rf’].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.merge_sf_with_seall">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_sf_with_seall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monthly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.merge_sf_with_seall" title="Permalink to this definition"></a></dt>
<dd><p>Merge m(d)sf with m(d)seall.</p>
<p>This method adjusts m(d)sf return (‘ret’) using m(d)seall delist return (‘dlret’). The adjusted return replaces
‘ret’ and ‘dlret’ column is added to m(d)sf.
For msf, this method also adds cash dividend columns, ‘cash_div’, to m(d)sf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sf</strong> – m(d)sf DataFrame.</p></li>
<li><p><strong>monthly</strong> – <cite>sf</cite> = msf if True, else <cite>sf</cite> = dsf.</p></li>
<li><p><strong>fill_method</strong> – <p>Method to fill missing dlret. 0: don’t fill, 1: JKP code, or 2: GHZ code.</p>
<ul>
<li><p>fill_method = 1:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dlret</cite> = -0.30 if <cite>dlstcd</cite> is 500 or between 520 and 584.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>fill_method = 2:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>dlret</cite> = -0.35 if <cite>dlstcd</cite> is 500 or between 520 and 584, and <cite>exchcd</cite> is 1 or 2.</p></li>
<li><p><cite>dlret</cite> = -0.55 if <cite>dlstcd</cite> is 500 or between 520 and 584, and <cite>exchcd</cite> is 3.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>m(d)sf with adjusted return (and cash dividend).</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Delist codes: <a class="reference external" href="http://www.crsp.com/products/documentation/delisting-codes">http://www.crsp.com/products/documentation/delisting-codes</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.preprocess_crsp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">preprocess_crsp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.preprocess_crsp" title="Permalink to this definition"></a></dt>
<dd><p>Create crspm and crspd.</p>
<p>This method calls <code class="docutils literal notranslate"><span class="pre">WRDS.merge_sf_with_seall()</span></code> and <code class="docutils literal notranslate"><span class="pre">WRDS.add_gvkey_to_crsp()</span></code> to add delist return,
gveky, and primary indicator to m(d)sf.
The result is saved to config.input_dir/crspm(d).pickle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.read_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.read_data" title="Permalink to this definition"></a></dt>
<dd><p>Read data from config.input_dir/<cite>library</cite>/<cite>table</cite>.pickle.</p>
<p><cite>library</cite> argument is redundant as if it is None, all folders under config.input_dir is searched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
<li><p><strong>index_col</strong> – (List of) column(s) to be set as index.</p></li>
<li><p><strong>sort_col</strong> – (List of) column(s) to sort data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(DataFrame) data read. Index = <cite>index_col</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.save_as_csv">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_as_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.save_as_csv" title="Permalink to this definition"></a></dt>
<dd><p>Read <cite>table</cite> and save it to a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
<li><p><strong>fpath</strong> – File path for the csv file. If None, the file is saved to config.input_dir/<cite>library</cite>/<cite>table</cite>.csv</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyanomaly.wrdsdata.WRDS.save_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">library</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyanomaly.wrdsdata.WRDS.save_data" title="Permalink to this definition"></a></dt>
<dd><p>Save <cite>data</cite> in pickle format.</p>
<p>We use pickle file format to store data as a pickle file preserves data types and is much faster to read
compared to a csv file. To convert a pickle file to a csv file, <code class="docutils literal notranslate"><span class="pre">WRDS.save_as_csv()</span></code> can be used.
The <cite>data</cite> is saved in the following location:</p>
<blockquote>
<div><ul class="simple">
<li><p>If <cite>library</cite> = None, config.input_dir/<cite>table</cite>.pickle</p></li>
<li><p>Otherwise, config.input_dir/<cite>library</cite>/<cite>table</cite>.pickle</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Data to save (DataFrame).</p></li>
<li><p><strong>table</strong> – File name without extension.</p></li>
<li><p><strong>library</strong> – Directory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="building_your_own.html" class="btn btn-neutral float-left" title="Bulding Your Own" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="support.html" class="btn btn-neutral float-right" title="Support" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Chulwoo Han and Jongho Kang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>